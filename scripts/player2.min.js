var prx=window.prx||{};prx.project={};prx.data={};prx.pages=[];prx.symbols=[];prx.templates=[];prx.maxPageId=0;prx.maxSymbolId=0;prx.iSelectedPage=0;prx.iSelectedPageId="";prx.iSelectedTemplate=-1;prx.types={};prx.devices={};prx.components={};prx.url={};prx.scroller={};prx.eventTransitionPage="";prx.editor=false;prx.shiftKeyDown=false;prx.statusbars={};prx.navigationbars={};prx.scrollableTabbars=[];prx.triggerData={};var _scrollers=[];var _previousPageId="";var _gobackstack=[];prx.fonts=[];prx.actions={};prx.actionIsRunning={};prx.actionLoopCounter={};prx.pagehash=true;prx.scrollPosition={};prx.easingTransitToTweenMax={linear:"Linear.easeNone","Linear.easeNone":"Linear.easeNone",ease:"Linear.ease","Linear.ease":"Linear.ease","in":"Linear.easeIn","Linear.easeIn":"Linear.easeIn",out:"Linear.easeOut","Linear.easeOut":"Linear.easeOut","in-out":"Linear.easeInOut","Linear.easeInOut":"Linear.easeInOut",swing:"Linear.easeInOut","Linear.easeInOut":"Linear.easeInOut",snap:"Strong.easeOutStrong","Strong.easeOutStrong":"Strong.easeOutStrong"};prx.easingTransitToTweenMaxReverse={linear:"Linear.easeNone","Linear.easeNone":"Linear.easeNone",ease:"Linear.ease","Linear.ease":"Linear.ease","in":"Linear.easeOut","Linear.easeIn":"Linear.easeOut",out:"Linear.easeIn","Linear.easeOut":"Linear.easeIn","in-out":"Linear.easeInOut","Linear.easeInOut":"Linear.easeInOut",swing:"Linear.easeInOut","Linear.easeInOut":"Linear.easeInOut",snap:"Strong.easeInStrong","Strong.easeOutStrong":"Strong.easeInStrong"};prx.defaultAnimEngine="Tweenmax";prx.allItems={};prx.stateTimelines={};prx.variables={};prx.variablesRegEx=new RegExp("{[a-z][-a-z0-9._]*}","gi");function setFFPointerEvents(value){var nodes=$("input, textarea");for(var i=0;i<nodes.length;i++){nodes[i].style.pointerEvents=value}_nodes=null}var log=function(s){try{console.log(s)}catch(err){}return false};var lag=function(s){try{console.log(s)}catch(err){}return false};var mlog=function(s){$(document.body).find("[data-role='page']").remove();$("#log").html(s);$("#log").show();return false};prx.getOrientation=function(){var elem=document.documentElement;return elem&&elem.clientWidth/elem.clientHeight<1.1?"portrait":"landscape"};prx.loadProject=function(filename){var _filename=filename;var _xt=new Date().getTime();if(typeof(prx.xdata)=="undefined"){$.post("/editor/data/loadpublished/?x="+_xt,{filename:_filename,vup:prx.vup,v:prx.v,rl:prx.rl,s3b:prx.s3b,ron:prx.ron},function(output){prx.parseLoadedData(output);prx.loadProjectCont()})}else{prx.parseLoadedData(prx.xdata);prx.loadProjectCont()}};prx.loadProjectCont=function(){$(window.document).trigger("mobileinit");$("body").css("background","white");var _activePage=$.mobile.activePage.get(0).id;var _page=prx.getPageStructFromId(_activePage);var _pageorientation=prx.getPageOrientation(_page);if(_orientation!=_pageorientation){var _$loader=$("#loader-wrapper").show();prx.changeOrientation();_$loader.find("span").text("0%");var _noOfImgs=$('[data-role=page] img:not([src=""])').length;var _loadedImgs=0;if(_noOfImgs==0){_$loader.hide()}$('[data-role=page] img:not([src=""])').unbind("load error").bind("load error",function(){_loadedImgs++;_$loader.find("span").text(Math.round(_loadedImgs*100/_noOfImgs)+"%");if(_loadedImgs==_noOfImgs){_$loader.hide()}})}else{$.mobile.changePage($("#"+_activePage),{allowSamePageTransition:true,transition:"none",changeHash:prx.pagehash})}$(window).bind("pagechange",function(event,obj){if(obj.options.fromHashChange){prx.eventTransitionPage="#"+obj.toPage[0].id;if(typeof(prx.scroller)!="undefined"){var _pgId=obj.toPage[0].id;$.each(prx.scroller,function(i,elm){if(i.substr(0,_pgId.length)==_pgId){if(typeof(prx.scrollPosition[i])!="undefined"){elm.scrollTo(prx.scrollPosition[i][0],prx.scrollPosition[i][1],0)}}})}}});$(window).orientationchange(function(event){if(parent==window){if(typeof(window.orientation)!="undefined"&&_windoworientation==window.orientation){return false}_windoworientation=window.orientation;prx.changeOrientation()}return true});$(document).on("focusout",":input",function(){window.scrollTo(0,0)});$(":input").click(function(e){e.stopPropagation()});if(prx.initialpageid!=false){if("p-"+prx.iinitialpageid!=$.mobile.activePage.get(0).id){$.mobile.changePage($("#p-"+prx.initialpageid),{allowSamePageTransition:true,transition:"none",changeHash:prx.pagehash})}$("#"+$.mobile.activePage.get(0).id).trigger("orientationchange")}else{if("p-"+prx.iSelectedPageId!=$.mobile.activePage.get(0).id){$.mobile.changePage($("#p-"+prx.iSelectedPageId),{allowSamePageTransition:true,transition:"none",changeHash:prx.pagehash})}}for(var i=0;i<prx.scrollableTabbars.length;i++){var _tabbar=prx.scrollableTabbars[i].container+"-"+prx.scrollableTabbars[i].id+"-inner";var _linked=prx.scrollableTabbars[i].container+"-"+prx.scrollableTabbars[i].linked+"-inner";var _bLinked=false;prx.scroller[_tabbar]=new IScroll("#"+_tabbar,{scrollX:true,scrollY:false,probeType:3,scrollbars:false,useTransition:true,momentum:false,snap:"li",linkedContainer:_linked});prx.scroller[_tabbar].on("scrollEnd",function(){if(typeof(prx.scroller[this.options.linkedContainer])!="undefined"){prx.scroller[this.options.linkedContainer].goToPage(this.currentPage.pageX,0,200)}});prx.scroller[_tabbar].on("scroll",function(){if(typeof(prx.scroller[this.options.linkedContainer])!="undefined"){prx.scroller[this.options.linkedContainer].scrollTo(this.x*2,0,0,false)}});prx.scroller[_tabbar].goToPage(Number(prx.scrollableTabbars[i].start),0,0)}};prx.parseLoadedData=function(data){var _project=$.evalJSON(data);prx.project=_project.project;prx.data=_project.data;prx.pages=_project.pages;prx.symbols=_project.symbols;prx.templates=_project.templates;prx.maxPageId=parseInt(_project.maxpageid);prx.maxSymbolId=parseInt(_project.maxsymbolid);prx.maxTemplateId=parseInt(_project.maxtemplateid);prx.iSelectedTemplate=parseInt(_project.iSelectedTemplate);prx.variables=_project.variables;prx.prepareVariables();if(typeof(_project.fonts)!="undefined"){prx.fonts=_project.fonts}prx.loadProjectFonts();if(typeof(_project.sort)!="undefined"){prx.sort=_project.sort}for(var n=0;n<prx.pages.length;n++){if(typeof(prx.pages[n].id)=="undefined"){prx.pages.splice(n,1)}else{prx.pages[n].id=parseInt(prx.pages[n].id)}}for(var n=0;n<prx.symbols.length;n++){if(typeof(prx.symbols[n].id)=="undefined"){prx.symbols.splice(n,1)}else{prx.symbols[n].id=parseInt(prx.symbols[n].id)}}for(var n=0;n<prx.templates.length;n++){if(typeof(prx.templates[n].id)=="undefined"){prx.templates.splice(n,1)}else{prx.templates[n].id=parseInt(prx.templates[n].id)}}if(typeof(_project.v5)!="undefined"&&_project.v5){prx.v5=_project.v5}else{prx.v5BackwardsCompatibility()}var _temporientation=prx.getOrientation();if(_temporientation=="portrait"){prx.iSelectedPageId=prx.project.startscreen;if(prx.getPageIndexFromId(prx.project.startscreen)>-1){prx.iSelectedPage=prx.getPageIndexFromId(prx.project.startscreen)}else{prx.iSelectedPage=0;prx.iSelectedPageId=parseInt(prx.pages[0].id)}}else{if(typeof(prx.project.startscreenlandscape)=="undefined"){prx.project.startscreenlandscape=1}prx.iSelectedPageId=prx.project.startscreenlandscape;if(prx.getPageIndexFromId(prx.project.startscreenlandscape)>-1){prx.iSelectedPage=prx.getPageIndexFromId(prx.project.startscreenlandscape)}else{prx.iSelectedPage=0;prx.iSelectedPageId=parseInt(prx.pages[0].id)}}_project=null;prx.refreshPanel();if(!prx.embed&&parent!=window){try{var data={pages:prx.pages,startscreen:(prx.deviceorientation=="portrait")?prx.project.startscreen:prx.project.startscreenlandscape};if(typeof(prx.sort)!="undefined"){data.sort=prx.sort.pages}parent.prx.iniPlayerReady(data)}catch(err){}}prx.buildAllItemsStruct()};prx.buildAllItemsStruct=function(){for(var i=0;i<prx.pages.length;i++){for(var j=0;j<prx.pages[i].states.length;j++){var data=$.evalJSON(prx.pages[i].states[j].data);for(var k=0;k<data.length;k++){if(typeof(prx.allItems[data[k].id])=="undefined"){prx.allItems[data[k].id]={containertype:"pages",containerindex:i,states:{}}}prx.allItems[data[k].id].states[prx.pages[i].states[j].id]={stateindex:j,itemindex:k}}}}for(var i=0;i<prx.templates.length;i++){for(var j=0;j<prx.templates[i].states.length;j++){var data=$.evalJSON(prx.templates[i].states[j].data);for(var k=0;k<data.length;k++){if(typeof(prx.allItems[data[k].id])=="undefined"){prx.allItems[data[k].id]={containertype:"templates",containerindex:i,states:{}}}prx.allItems[data[k].id].states[prx.templates[i].states[j].id]={stateindex:j,itemindex:k}}}}for(var i=0;i<prx.symbols.length;i++){for(var j=0;j<prx.symbols[i].states.length;j++){var data=$.evalJSON(prx.symbols[i].states[j].data);for(var k=0;k<data.length;k++){if(typeof(prx.allItems[data[k].id])=="undefined"){prx.allItems[data[k].id]={containertype:"symbols",containerindex:i,states:{}}}prx.allItems[data[k].id].states[prx.symbols[i].states[j].id]={stateindex:j,itemindex:k}}}}};prx.prepareVariables=function(){for(var key in prx.variables){if(prx.variables.hasOwnProperty(key)){if(typeof(prx.variables[key].type)=="undefined"){prx.variables[key].type="text"}if(typeof(prx.variables[key].value)=="undefined"){prx.variables[key].value=""}if(typeof(prx.variables[key].evaluate)=="undefined"){prx.variables[key].evaluate=true}}}};prx.variablesParamExists=function(value){try{if(value.search(prx.variablesRegEx)>-1){return true}else{return false}}catch(err){return false}};prx.removeFirstLast=function(text){return text.substring(1,text.length-1)};prx.readVariable=function(key){if(typeof(prx.variables[key])!="undefined"){if(typeof(prx.variables[key].parsed)=="undefined"){prx.recursiveEvaluation(prx.variables[key].value,key)}return prx.variables[key].parsed}else{return false}};prx.recursiveEvaluation=function(value,key,update){if(update){if(key.length>0){if(typeof(prx.variables[key])!="undefined"){if(typeof(prx.variables[key].parsed)!="undefined"){delete prx.variables[key].parsed}}}}else{update=false;if(key.length>0){if(typeof(prx.variables[key])!="undefined"){if(typeof(prx.variables[key].parsed)!="undefined"){return prx.variables[key].parsed}}}}if(prx.variablesParamExists(value)){var _matches=value.match(prx.variablesRegEx);if(_matches!=null){for(var i=0;i<_matches.length;i++){var _toReplace=_matches[i];var _key=prx.removeFirstLast(_matches[i]);if(!((key==_key)&&(prx.variables[key].value==key))){try{value=value.replace(_toReplace,prx.recursiveEvaluation(prx.variables[_key].value,_key,update))}catch(err){value=value.replace(_toReplace,"")}}else{value=value.replace(_toReplace,"")}}}}else{if(typeof(key)!="undefined"){if(typeof(prx.variables[key])!="undefined"){if(prx.variables[key].evaluate){value=eval(value)}}}}if(typeof(_key)!="undefined"){if(typeof(prx.variables[key])!="undefined"){if(prx.variables[key].evaluate){value=eval(value)}}}if(key.length>0){if(typeof(prx.variables[key])!="undefined"){prx.variables[key].parsed=value}}if(key.length>0){if(typeof(prx.variables[key])!="undefined"){switch(prx.variables[key].type){case"text":break;case"numeric":value=parseFloat(value);break;case"boolean":value=(value)?true:false;break}}}return value};prx.showGoFullScreenMessage=function(){if(("standalone" in window.navigator)&&!window.navigator.standalone){$(document.body).find("[data-role='page']").remove();$("#appModeNote").show()}};prx.getPageIndexFromElementId=function(id){if(id.substring(0,1)=="#"){return id.substring(3)}else{return id.substring(2)}};prx.getPageIndexFromId=function(id){var rIndex=-1;for(var n=0;n<prx.pages.length;n++){if(prx.pages[n].id==id){rIndex=n}}return rIndex};prx.getTemplateIndexFromId=function(id){var rIndex=-1;for(var n=0;n<prx.templates.length;n++){if(prx.templates[n].id==id){rIndex=n}}return rIndex};prx.getSymbolIndexFromId=function(id){var rIndex=-1;for(var n=0;n<prx.symbols.length;n++){if(prx.symbols[n].id==id){rIndex=n}}return rIndex};prx.getPageStructFromId=function(pageid){var _id=prx.getPageIndexFromElementId(pageid);return prx.pages[prx.getPageIndexFromId(_id)]};prx.refreshPanel=function(){var _$loader=$("#loader-wrapper").show();prx.preLoadPages();_$loader.find("span").text("0%");var _noOfImgs=$('[data-role=page] img:not([src=""])').length;var _loadedImgs=0;if(_noOfImgs==0){_$loader.hide()}$('[data-role=page] img:not([src=""])').bind("load error",function(){_loadedImgs++;_$loader.find("span").text(Math.round(_loadedImgs*100/_noOfImgs)+"%");if(_loadedImgs==_noOfImgs){_$loader.hide()}});setTimeout(function(){_$loader.hide();$('[data-role=page] img:not([src=""])').unbind("load error")},10000)};prx.preLoadPages=function(){$.each(prx.pages,function(i,page){prx.preLoadPage(page)})};prx.loadPageEvents=function(pageid){var _pageid="";$.each(prx.pages,function(i,page){if(page.id==pageid){_pageid=page.id;$("#p-"+pageid).unbind("pagebeforeshow").bind("pagebeforeshow",function(event,ui){_previousPageId=ui.prevPage.get(0).id;if(prx.allowstatusbar&&prx.statusbars[page.id].statusbar=="1"){try{if(prx.export2html!="1"){$("#statusbar").css({"background-image":prx.buildStatusBarAsset(prx.statusbars[page.id].orientation)})}else{if(prx.statusbarapplies=="1"){$("#statusbar").css("background-image","url(./images/statusbar_"+prx.statusbars[page.id].orientation+".png)")}else{$("#statusbar").css("background-image","none")}}$("#statusbar").css("height",prx.devices[prx.device]["statusbarheight"+prx.statusbars[page.id].orientation]+"px")}catch(err){}$("#p-"+page.id).css("top",prx.devices[prx.device]["statusbarheight"+prx.statusbars[page.id].orientation]+"px")}else{if(page.background=="none"){$("#statusbar").css("height","0px")}$("#p-"+page.id).css("top","0px")}if(prx.allownavigationbar&&prx.navigationbars[page.id].navigationbar=="1"){try{if(prx.export2html!="1"){$("#navigationbar").css({"background-image":prx.buildNavigationBarAsset(prx.navigationbars[page.id].orientation)})}else{if(prx.navigationbarapplies=="1"){$("#navigationbar").css("background-image","url(./images/navigationbar_"+prx.statusbars[page.id].orientation+".png)")}else{$("#statusbar").css("background-image","none")}}$("#navigationbar").css("height",prx.devices[prx.device]["navigationbarheight"+prx.navigationbars[page.id].orientation]+"px");$("#navigationbar").css("top",prx.devices[prx.device][prx.navigationbars[page.id].orientation][1]-prx.devices[prx.device]["navigationbarheight"+_orientation]+"px")}catch(err){}}else{$("#navigationbar").css("height","0px")}});$("#p-"+pageid).bind("pagebeforehide",function(event,ui){prx.renderOverlay("#p-"+pageid)});$("#p-"+pageid).bind("pagehide",function(event,ui){$(this).find(".type-list input, .type-list-retina input, .type-android-listbasic input").not(".listitem-type-checkbox input").removeAttr("checked")});prx.parsePageAction(i);for(var j=0;j<page.states.length;j++){prx.parsePageStateAction(i,j)}prx.loadItemEvents(page,"page",pageid,"")}})};prx.renderOverlay=function(pageid){var _pageid=pageid;var _statusbar=prx.statusbars[pageid.substr(3)];var _top=0;var _height=prx.devices[prx.device][_statusbar.orientation][1];if(prx.allowstatusbar&&_statusbar.statusbar=="1"){_top=prx.devices[prx.device]["statusbarheight"+_statusbar.orientation];_height-=_top}var $overlay=$("#overlay");$(_pageid).find('[data-mpoverlay="1"]').each(function(){var _elmTop=$(this).offset().top-_top;$(this).clone().css("top",_elmTop).find("input").attr("id",function(){return $(this).attr("id")+"-overlay"}).attr("name",function(){return $(this).attr("name")+"-overlay"}).end().find("label").attr("for",function(){return $(this).attr("for")+"-overlay"}).end().appendTo($overlay)});$overlay.css("top",_top+"px").height(_height);$("#overlay").show()};prx.loadTemplateEvents=function(template,pageid,containerid){var index=prx.getTemplateIndexFromId(template.id);var stateindex=prx.getTemplateStateIndexFromId(template.stateid,index);if(index==-1||stateindex==-1){return false}for(var j=0;j<prx.templates[index].states.length;j++){prx.parseTemplateStateAction(index,j,pageid,containerid)}if(index>-1&&stateindex>-1){prx.loadItemEvents(prx.templates[index].states[stateindex],"template",pageid,template.id,containerid)}};prx.loadSymbolEvents=function(symbolid,pageid,templateid,containerid){var _symbolid="";$.each(prx.symbols,function(i,symbol){if(symbol.id==symbolid){prx.loadItemEvents(symbol,"symbol",pageid,templateid,containerid)}});return false};prx.loadItemEvents=function(data,type,pageid,templateid,containerid){var _data="";var _prefix="";if(type=="page"){_data=$.evalJSON(data.states[0].data);_prefix="p-"+pageid}if(type=="template"){_data=$.evalJSON(data.data);_prefix="p-"+pageid;if(typeof(containerid)!="undefined"&&containerid!=""){_prefix+="-"+containerid}}if(type=="symbol"){_data=$.evalJSON(data.states[0].data);_prefix="p-"+pageid+"-"+containerid+"-"}$.each(_data,function(i,item){prx.parseItemAction(item,_prefix,pageid,templateid)})};prx.parseItemAction=function(item,containerid,pageid,templateid,clicktotap){var _target="";if(typeof(item._fromstateid)!="undefined"){return true}if(typeof(clicktotap)=="undefined"){clicktotap=false}if(typeof(containerid)!="undefined"){if(typeof(templateid)!="undefined"&&templateid!=""){containerid=containerid+"-t"+templateid}_id=containerid+"-"+item.id;_target=containerid+"-"}else{_id=item.id;_target=""}if(typeof(item.actions)!="undefined"){if(item.actions.length>0){item.actions.sort(function(a,b){return(a.sort-b.sort)})}}switch(item.type){case"listbasic":case"listnested":case"listwithicon":case"listwithvalue":case"listnestedwithvalue":case"listwithiconandvalue":case"listwithbadge":case"listnestedwithbadge":case"listwithiconandbadge":case"listcomplex":case"listbasic_retina":case"listnested_retina":case"listwithicon_retina":case"listwithvalue_retina":case"listnestedwithvalue_retina":case"listwithiconandvalue_retina":case"listwithbadge_retina":case"listnestedwithbadge_retina":case"listwithiconandbadge_retina":case"listcomplex_retina":case"android_listbasic":if(typeof(item.listitems)=="undefined"){item.listitems=[]}$.each(item.listitems,function(i,listitem){if(typeof(listitem)=="undefined"){return true}if(typeof(listitem.actions)=="undefined"){listitem.actions=[]}if(listitem.actions.length!=0){$("#"+_id+"-listitems-"+i+" > .action-highlight").remove();$("#"+_id+"-listitems-"+i).append("<div class='action-highlight'></div>")}var bindTo="#"+_id+"-listitems-"+i;$(bindTo).unbind(".protoio");$.each(listitem.actions,function(j,action){action.bindTo=bindTo;action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.containerid=containerid;if(typeof(action.delay)=="undefined"||action.delay==0){action.delay=10}prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+"-listitems-"+i+" .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}})});break;case"buttongroup":case"pagecontroller":case"buttongroup_retina":case"pagecontroller_retina":case"actionsheet":case"actionsheet_retina":case"alert":case"alert_retina":case"metro_appbar":case"metro_appbar_mini":case"metro_charms":case"metro_filters":case"metro_contextmenu":case"metro_dropdown":case"metro_dropdown_withselection":case"metro_select":case"metro_dialog":case"metro_warningbar":if(typeof(item.buttons)=="undefined"){item.buttons=[]}$.each(item.buttons,function(i,button){if(typeof(button)=="undefined"){return true}if(typeof(button.actions)=="undefined"){button.actions=[]}if(button.actions.length!=0){$("#"+_id+"-buttons-"+i+" > .action-highlight").remove();$("#"+_id+"-buttons-"+i).append("<div class='action-highlight'></div>")}var bindTo="#"+_id+"-buttons-"+i;$(bindTo).unbind(".protoio");$.each(button.actions,function(j,action){action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.bindTo=bindTo;action.containerid=containerid;prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+"-buttons-"+i+" .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}})});break;case"segmentedcontrol":case"segmentedcontrol_retina":case"android_dropdown":if(typeof(item.options)=="undefined"){item.options=[]}$.each(item.options,function(i,option){if(typeof(option)=="undefined"){return true}if(typeof(option.actions)=="undefined"){option.actions=[]}if(option.actions.length!=0){$("#"+_id+"-options-"+i+" > .action-highlight").remove();$("#"+_id+"-options-"+i+" label").append("<div class='action-highlight'></div>")}var bindTo="#"+_id+"-options-"+i;$(bindTo).unbind(".protoio");$.each(option.actions,function(j,action){action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.bindTo=bindTo;action.containerid=containerid;prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+"-options-"+i+" .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}})});break;case"tabbar":case"tabbar_retina":case"basic_tabbar":case"android_fixedtabbar":if(typeof(item.tabs)=="undefined"){item.tabs=[]}$.each(item.tabs,function(i,tab){if(typeof(tab)=="undefined"){return true}if(typeof(tab.actions)=="undefined"){tab.actions=[]}if(tab.actions.length!=0){$("#"+_id+"-tabs-"+i+" > .action-highlight").remove();$("#"+_id+"-tabs-"+i).append("<div class='action-highlight'></div>")}var bindTo="#"+_id+"-tabs-"+i;$(bindTo).unbind(".protoio");$.each(tab.actions,function(j,action){action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.bindTo=bindTo;action.containerid=containerid;prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+"-tabs-"+i+" .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}})});break;case"flipswitch":case"flipswitch_retina":case"flipswitch_ios5":case"flipswitch_ios5_retina":case"android_onoffswitch":case"metro_onoff":if(typeof(item.flipswitchActionsOnActive)=="undefined"){if(typeof(item.actionsOnActive)=="undefined"){item.flipswitchActionsOnActive=[]}else{item.flipswitchActionsOnActive=item.actionsOnActive}}if(typeof(item.flipswitchActionsOnDeactive)=="undefined"){if(typeof(item.actionsOnDeactive)=="undefined"){item.flipswitchActionsOnDeactive=[]}else{item.flipswitchActionsOnDeactive=item.actionsOnDeactive}}if(typeof(item.flipswitchActionsOnDeactive)!="undefined"){item.flipswitchActionsOnDeactive.sort(function(a,b){return(a.sort-b.sort)})}if(typeof(item.flipswitchActionsOnActive)!="undefined"){item.flipswitchActionsOnActive.sort(function(a,b){return(a.sort-b.sort)})}if(item.flipswitchActionsOnActive.length!=0||item.flipswitchActionsOnDeactive.length!=0){$("#"+_id+" > .action-highlight").remove();$("#"+_id).append("<div class='action-highlight'></div>")}$.each(item.flipswitchActionsOnActive,function(j,action){if(action.type=="click"||action.type=="tap"){action.type="change"}action.bindTo="input:checked[id="+_id+"-flipswitch]";action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.containerid=containerid;action.live=true;prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+" .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}});$.each(item.flipswitchActionsOnDeactive,function(j,action){if(action.type=="click"||action.type=="tap"){action.type="change"}action.bindTo="input[id="+_id+"-flipswitch]:not(:checked)";action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.containerid=containerid;action.live=true;prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+" .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}});break;case"checkbox":case"checkbox_retina":case"radiobutton":case"radiobutton_retina":case"android_checkbox":case"android_radiobutton":case"metro_checkbox":case"metro_radiobutton":if(typeof(item.checkboxActionsOnActive)=="undefined"){item.checkboxActionsOnActive=[]}if(typeof(item.checkboxActionsOnDeactive)=="undefined"){item.checkboxActionsOnDeactive=[]}if(item.checkboxActionsOnActive.length!=0||item.checkboxActionsOnDeactive.length!=0){$("#"+_id+" > .action-highlight").remove();$("#"+_id).append("<div class='action-highlight'></div>")}$.each(item.checkboxActionsOnActive,function(j,action){if(action.type=="click"||action.type=="tap"){action.type="change"}action.bindTo="input:checked[id="+_id+"-checkbox]";action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.containerid=containerid;action.live=true;prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+" .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}});$.each(item.checkboxActionsOnDeactive,function(j,action){if(action.type=="click"||action.type=="tap"){action.type="change"}action.bindTo="input[id="+_id+"-checkbox]:not(:checked)";action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.containerid=containerid;action.live=true;prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+" .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}});break;case"android_actionbar":case"android_actionbar_contextual":if(typeof(item.actionbarActionOverflowActions)=="undefined"){if(typeof(item.actions)=="undefined"){item.actionbarActionOverflowActions=[]}else{item.actionbarActionOverflowActions=item.actions}}if(typeof(item.actionbarActionOverflowActions)!="undefined"){item.actionbarActionOverflowActions.sort(function(a,b){return(a.sort-b.sort)})}if(item.actionbarActionOverflowActions.length!=0){$("#"+_id+" > .action-highlight").remove();$("#"+_id+" .actionOverflow").append("<div class='action-highlight'></div>")}var bindTo="#"+_id+" .actionOverflow";$(bindTo).unbind(".protoio");$.each(item.actionbarActionOverflowActions,function(j,action){action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.bindTo=bindTo;action.containerid=containerid;prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+" .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}});if(typeof(item.actionbarUpCaretActions)=="undefined"){item.actionbarUpCaretActions=[]}if(typeof(item.actionbarUpCaretActions)!="undefined"){item.actionbarUpCaretActions.sort(function(a,b){return(a.sort-b.sort)})}if(item.actionbarUpCaretActions.length!=0){$("#"+_id+" .left-icon").append("<div class='action-highlight'></div>")}var bindTo="#"+_id+" .left-icon";$(bindTo).unbind(".protoio");$.each(item.actionbarUpCaretActions,function(j,action){action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.bindTo=bindTo;action.containerid=containerid;prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+" .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}});break;case"symbol":if(typeof(item.actions)=="undefined"){item.actions=[]}if(item.actions.length!=0){$("#"+_id+" > .action-highlight").remove();$("#"+_id).append("<div class='action-highlight'></div>")}var bindTo="#"+_id;$(bindTo).unbind(".protoio");$.each(item.actions,function(j,action){action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.bindTo=bindTo;action.containerid=containerid;prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+" > .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}});break;default:if(typeof(item.actions)=="undefined"){item.actions=[]}if(item.actions.length!=0){$("#"+_id).append("<div class='action-highlight'></div>")}var bindTo="#"+_id;$(bindTo).unbind(".protoio");$.each(item.actions,function(j,action){action.targetId=(action.itemId==-1)?"#"+_target.slice(0,-1):"#"+_target+action.itemId;action.bindTo=bindTo;action.containerid=containerid;prx.buildAction(action,clicktotap);if(typeof(action.enabled)=="undefined"||action.enabled){$("#"+_id+" .action-highlight").append('<span class="actionicon action-'+action.type+'" title="'+action.type+": "+action.title+'"></span>')}});break}};prx.parsePageAction=function(index){var _page=prx.pages[index];if(typeof(_page.actions)!="undefined"){$.each(_page.actions,function(i,action){action.bindTo="#p-"+_page.id;action.containerid="p-"+_page.id;action.targetId=action.bindTo+"-"+action.itemId;if(action.type=="keydown"){action.bindTo=document;action.bindPageId="p-"+_page.id}prx.buildAction(action)})}};prx.parsePageStateAction=function(index,stateindex){if(stateindex==-1){return false}var _page=prx.pages[index];var _state=_page.states[stateindex];if(typeof(_state.actions)!="undefined"){_state.actions.sort(function(a,b){return(a.sort-b.sort)});$.each(_state.actions,function(i,action){action.bindTo="#p-"+_page.id+"[data-state-id="+_state.id+"]";action.containerid="p-"+_page.id;action.targetId=action.bindTo+"-"+action.itemId;action.live=true;prx.buildAction(action)})}};prx.parseTemplateStateAction=function(index,stateindex,pageid,containerid){if(stateindex==-1){return false}var _prefix="p-"+pageid;if(typeof(containerid)!="undefined"&&containerid!=""){_prefix+="-"+containerid}var _template=prx.templates[index];var _state=_template.states[stateindex];if(typeof(_state.actions)!="undefined"){_state.actions.sort(function(a,b){return(a.sort-b.sort)});$.each(_state.actions,function(i,action){action.bindTo="#"+_prefix+"-t"+prx.templates[index].id+"[data-state-id="+_state.id+"]";action.containerid=_prefix;action.targetId=action.bindTo+"-"+action.itemId;action.live=true;prx.buildAction(action)})}};prx.parseSymbolStateAction=function(index,stateindex,pageid,containerid,itemid){if(stateindex==-1){return false}var _symbol=prx.symbols[index];var _state=_symbol.states[stateindex];if(typeof(_state.actions)!="undefined"){_state.actions.sort(function(a,b){return(a.sort-b.sort)});$.each(_state.actions,function(i,action){action=$.evalJSON($.toJSON(action));action.bindTo="#"+containerid+"[data-state-id="+_state.id+"]";if(action.pageId==-1){action.pageId=pageid}action.containerid=containerid;action.targetId="#"+containerid+((action.itemId!=-1)?"-"+action.itemId:"");action.allowOverwriteTargetId=false;action.live=true;prx.buildAction(action)})}};prx.changeOrientation=function(){var _deviceOrientation=prx.getOrientation();try{var _activePage=$.mobile.activePage.get(0).id;if(typeof($._data($("#"+_activePage).get(0),"events"))=="undefined"||(typeof($._data($("#"+_activePage).get(0),"events"))!="undefined"&&typeof($._data($("#"+_activePage).get(0),"events").changeorientation)=="undefined")){var _id=prx.getPageIndexFromElementId(_activePage);var _page=prx.pages[prx.getPageIndexFromId(_id)];$("#"+_activePage).html("");prx.rePreloadPage(_page);$.mobile.changePage($("#"+_activePage),{transition:"none",allowSamePageTransition:true,changeHash:prx.pagehash})}else{jQuery.each($._data($("#"+_activePage).get(0),"events"),function(i,event){jQuery.each(event,function(i,handler){if(handler.type=="changeorientation"){$("#"+_activePage).trigger("changeorientation")}})})}}catch(e){}return true};prx.rePreloadPage=function(_page){_page.orientation=prx.getOrientation();prx.preLoadPage(_page)};prx.actionLoadPage=function(action){if(action.animation==""){action.animation="none"}var _loadTransitions=[];_loadTransitions.slide="slidenofadeload";_loadTransitions.slideback="slidebacknofadeload";_loadTransitions.slidedown="slidedownnofadeload";_loadTransitions.slideup="slideupnofadeload";_loadTransitions.pop="popnofadeload";_loadTransitions.fade="fadenofadeload";_loadTransitions.flip="flipnofadeload";_loadTransitions.turn="turnnofadeload";_loadTransitions.flow="flownofadeload";if(typeof _loadTransitions[action.animation]!="undefined"){action.animation=_loadTransitions[action.animation]}var _activePage=$.mobile.activePage.get(0).id;$("#p-"+action.pageId).attr("loadedFrom",$.mobile.activePage.get(0).id);var _loadedFrom=$("#"+$.mobile.activePage.get(0).id);$(_loadedFrom).addClass("loadedFrom");$("#p-"+action.pageId).addClass("loadedTo");var _reverse=false;var _transition=action.animation;if(action.animation=="slideback"){_reverse=true;_transition="slide"}$("#p-"+action.pageId).one("pageshow",function(){prx.callbackAction(action)});setTimeout(function(){$.mobile.changePage($("#p-"+action.pageId),{transition:_transition,changeHash:prx.pagehash,reverse:_reverse})},action.delay)};prx.actionUnloadPage=function(action){var _unloadTransitions=[];_unloadTransitions.slide="slidenofadeunload";_unloadTransitions.slideback="slidebacknofadeunload";_unloadTransitions.slidedown="slidedownnofadeunload";_unloadTransitions.slideup="slideupnofadeunload";_unloadTransitions.pop="popnofadeunload";_unloadTransitions.fade="fadenofadeunload";_unloadTransitions.flip="flipnofadeunload";_unloadTransitions.turn="turnnofadeunload";_unloadTransitions.flow="flownofadeunload";if(typeof _unloadTransitions[action.animation]!="undefined"){action.animation=_unloadTransitions[action.animation]}if(action.animation==""){action.animation="none"}var _loadedPage=$.mobile.activePage.get(0).id;var _showPage=$("#"+_loadedPage).attr("loadedFrom");if(typeof(_showPage)!="undefined"){var _reverse=false;var _transition=action.animation;if(action.animation=="slideback"){_reverse=true;_transition="slide"}var _events=$._data($("#"+_showPage).get(0),"events").pageshow;delete $._data($("#"+_showPage).get(0),"events").pageshow;$("#"+_showPage).one("pageshow",function(){$._data($(this).get(0),"events").pageshow=_events;if(!prx.embed&&parent!=window){try{parent.prx.highlightPage(_showPage.substr(2))}catch(err){}}$("#"+_loadedPage).removeClass("loadedTo");$("#"+_showPage).removeClass("loadedFrom");_showPage=null;prx.callbackAction(action)});setTimeout(function(){$.mobile.changePage($("#"+_showPage),{allowSamePageTransition:true,transition:_transition,changeHash:prx.pagehash,reverse:_reverse})},action.delay)}};prx.actionHideItem=function(action){var targetId=action.targetId;if(typeof(action.pageId)!="undefined"&&action.pageId!=-1){targetId="#p-"+action.pageId+"-"+action.itemId}setTimeout(function(){$(targetId).hide();$(targetId).addClass("hidden");prx.callbackAction(action)},action.delay)};prx.actionShowItem=function(action){var targetId=action.targetId;if(typeof(action.pageId)!="undefined"&&action.pageId!=-1){targetId="#p-"+action.pageId+"-"+action.itemId}setTimeout(function(){$(targetId).show();$(targetId).removeClass("hidden");if(typeof(prx.scroller[targetId.substring(1)+"-inner"])!="undefined"){prx.scroller[targetId.substring(1)+"-inner"].refresh()}if($(targetId).hasClass("type-symbol")){$(targetId+" .box").each(function(){if(typeof(prx.scroller[this.id+"-inner"])!="undefined"){prx.scroller[this.id+"-inner"].refresh()}})}prx.callbackAction(action)},action.delay)};prx.actionToggleItem=function(action){var targetId=action.targetId;setTimeout(function(){$(targetId).toggle().toggleClass("hidden");if(!$(targetId).hasClass("hidden")){if(typeof(prx.scroller[targetId.substring(1)+"-inner"])!="undefined"){prx.scroller[targetId.substring(1)+"-inner"].refresh()}if($(targetId).hasClass("type-symbol")){$(targetId+" .box").each(function(){if(typeof(prx.scroller[this.id+"-inner"])!="undefined"){prx.scroller[this.id+"-inner"].refresh()}})}}prx.callbackAction(action)},action.delay)};prx.actionGoToPage=function(action){var _pageid="#p-"+action.pageId;var _currentpage=_pageid;action.pageId=action.pageId;try{_currentpage="#"+$.mobile.activePage.get(0).id}catch(err){_currentpage="#"+$(".ui-page-active").first().attr("id")}var _pgId=_currentpage.substr(1);$.each(prx.scroller,function(i,elm){if(i.substr(0,_pgId.length)==_pgId){prx.scrollPosition[i]=[elm.x,elm.y]}});if(typeof(action.delay)=="undefined"){action.delay=0}if(action.animation==""){action.animation="none"}var _Transitions=[];_Transitions.slidedown="slidedownnofade";_Transitions.slideup="slideupnofade";_Transitions.pop="popnofade";_Transitions.none="customnone";if(typeof _Transitions[action.animation]!="undefined"){action.animation=_Transitions[action.animation]}if(_pageid!=_currentpage){if((_pageid!=prx.eventTransitionPage)||(prx.eventTransitionPage=="#p-_back")){if(action.pageId=="_back"){_pageid=_gobackstack[_gobackstack.length-1];_gobackstack.pop()}var _targetPage=prx.getPageStructFromId(_pageid);var _pageOrientation=prx.getPageOrientation(_targetPage);if(_pageOrientation!=prx.getOrientation()){if(!prx.embed&&parent!=window){try{parent.prx.switchOrientation()}catch(err){}}}$(".loadedFrom").removeClass("loadedFrom").addClass("remove-on-pageshow").addClass("ui-page-active");if(action.pageId!="_back"){_gobackstack.push(_currentpage);if(_gobackstack.length>=50){_gobackstack.shift()}}var _reverse=false;var _transition=action.animation;if(action.animation=="slideback"){_reverse=true;_transition="slide"}setTimeout(function(){$.mobile.changePage($(_pageid),{transition:_transition,changeHash:prx.pagehash,reverse:_reverse});prx.eventTransitionPage="#p-"+action.pageId},action.delay);$(_pageid).one("pageshow",function(){var _pgId=_pageid.substr(1);if(typeof(prx.scroller)!="undefined"){$.each(prx.scroller,function(i,elm){if(i.substr(0,_pgId.length)==_pgId){if(typeof(prx.scrollPosition[i])!="undefined"){elm.scrollTo(prx.scrollPosition[i][0],prx.scrollPosition[i][1],0)}}})}prx.callbackAction(action)});$.mobile.silentScroll(0,0)}}else{setTimeout(function(){prx.callbackAction(action)},action.delay)}};prx.actionGoToCarouselPage=function(action){var _snap=false;if(typeof(prx.scroller[action.targetId.substr(1)+"-inner"])!="undefined"){_snap=prx.scroller[action.targetId.substr(1)+"-inner"].options.snap}else{return false}if(_snap){if(typeof(action.pageId)!="undefined"&&action.pageId!=-1){targetId="#p-"+action.pageId+"-"+action.itemId}var _pageX=action.itemIndex[0];var _pageY=action.itemIndex[1];if(_pageX==""){_pageX="nochange"}if(_pageY==""){_pageY="nochange"}if(typeof(action.animationDuration)=="undefined"){action.animationDuration=400}var _scroller=prx.scroller[action.targetId.substr(1)+"-inner"];var _targetPageX=_scroller.currentPage.pageX;var _targetPageY=_scroller.currentPage.pageY;setTimeout(function(){switch(_pageX){case"previous":_targetPageX--;if(_targetPageX<0){_targetPageX=0}break;case"next":_targetPageX++;if(_targetPageX>_scroller.pages.length){_targetPageX=_scroller.pages.length}break;case"nochange":_targetPageX=_scroller.currentPage.pageX;break;default:_targetPageX=parseInt(_pageX);break}switch(_pageY){case"previous":_targetPageY--;if(_targetPageY<0){_targetPageY=0}break;case"next":_targetPageY++;if(_targetPageY>_scroller.pages[0].length){_targetPageY=_scroller.pages[0].length}break;case"nochange":_targetPageY=_scroller.currentPage.pageY;break;default:_targetPageY=parseInt(_pageY);break}_pageX=parseInt(_targetPageX);_pageY=parseInt(_targetPageY);var _scrollableTabbarContainer=false;for(var i=0;i<prx.scrollableTabbars.length;i++){if(action.targetId=="#"+prx.scrollableTabbars[i].container+"-"+prx.scrollableTabbars[i].linked){_scrollableTabbarContainer=prx.scrollableTabbars[i].container+"-"+prx.scrollableTabbars[i].id;break}}prx.scroller[action.targetId.substr(1)+"-inner"].goToPage(_pageX,_pageY,parseInt(action.scrollDuration));if(_scrollableTabbarContainer!=false){prx.scroller[_scrollableTabbarContainer+"-inner"].goToPage(_pageX,0,parseInt(action.scrollDuration))}},action.delay)}setTimeout(function(){prx.callbackAction(action)},parseInt(action.delay)+parseInt(action.scrollDuration))};prx.actionScrollScrollableContainer=function(action){if(typeof(prx.scroller[action.targetId.substr(1)+"-inner"])=="undefined"){return false}if(typeof(action.horizontalPx)=="undefined"){action.horizontalPx=0}if(typeof(action.verticalPx)=="undefined"){action.verticalPx=0}switch(action.scrollType){case"scroll-to":var _horizontalPx=-parseInt(action.horizontalPx);var _verticalPx=-parseInt(action.verticalPx);if(action.horizontalPx=="*"){_horizontalPx=prx.scroller[action.targetId.substr(1)+"-inner"].x}if(action.verticalPx=="*"){_verticalPx=prx.scroller[action.targetId.substr(1)+"-inner"].y}setTimeout(function(){prx.scroller[action.targetId.substr(1)+"-inner"].scrollTo(_horizontalPx,_verticalPx,parseInt(action.scrollDuration))},action.delay);break;case"scroll-by":var _horizontalPx=parseInt(action.horizontalPx);var _verticalPx=parseInt(action.verticalPx);if(action.horizontalPx=="*"){_horizontalPx=0}if(action.verticalPx=="*"){_verticalPx=0}setTimeout(function(){prx.scroller[action.targetId.substr(1)+"-inner"].scrollBy(_horizontalPx,_verticalPx,parseInt(action.scrollDuration))},action.delay);break}setTimeout(function(){prx.callbackAction(action)},parseInt(action.delay)+parseInt(action.scrollDuration))};prx.actionFireItemEvent=function(action){if(action.itemEvent=="click"){action.itemEvent="tap"}if(action.targetType=="container"){var pageid=action.containerid.split("-")[1];action.targetId="#p-"+pageid+" .type-symbol[data-symbol-id="+action.symbolId+"] [id$=-"+action.itemId+"]";var $item=$(action.targetId);if($item.length==0){prx.callbackAction(action);return}else{action.targetId="#"+$item.attr("id")}}else{action.targetId="#p-"+action.pageId+"-"+action.itemId}setTimeout(function(){if(typeof(action.itemIndex)=="undefined"){$(action.targetId).trigger(action.itemEvent)}else{if(parseInt(action.itemIndex)==action.itemIndex){$(action.targetId+"-"+action.itemDynProps+"-"+action.itemIndex).trigger(action.itemEvent)}else{switch(action.itemIndex){case"actionbarUpCaretActions":$(action.targetId+" .left-icon").trigger(action.itemEvent);break;case"actionbarActionOverflowActions":$(action.targetId+" .actionOverflow").trigger(action.itemEvent);break;case"flipswitchActionsOnActive":$(action.targetId+" input:checked[id="+_id+"-flipswitch]").trigger(action.itemEvent);break;case"flipswitchActionsOnDeactive":$(action.targetId+" input[id="+_id+"-flipswitch]:not(:checked)").trigger(action.itemEvent);break;case"checkboxActionsOnActive":$(action.targetId+" input:checked[id="+_id+"-checkbox]").trigger(action.itemEvent);break;case"checkboxActionsOnDeactive":$(action.targetId+" input[id="+_id+"-checkbox]:not(:checked)").trigger(action.itemEvent);break;default:break}}}prx.callbackAction(action)},action.delay)};prx.actionAnimateItem=function(action){var animEngine=prx.defaultAnimEngine;if(action.animationEasing.substring(0,12)=="cubic-bezier"){animEngine="Transit"}switch(animEngine){case"Transit":var props={easing:action.animationEasing,duration:action.duration,queue:false};break;default:var props={};var options={duration:parseInt(action.duration),easing:action.animationEasing,queue:false,complete:function(){prx.callbackAction(action)}};action.animationEasing=prx.easingTransitToTweenMax[action.animationEasing];break}switch(action.animationType){case"move-item":switch(action.moveType){case"move-by":props.top=true;props.left=true;if(action.moveXBy!="*"){var x=Number(action.moveXBy);if(x>=0){x="+="+x}else{x="-="+-x}props.left=x}if(action.moveYBy!="*"){var y=Number(action.moveYBy);if(y>=0){y="+="+y}else{y="-="+-y}props.top=y}switch(animEngine){case"Transit":setTimeout(function(){$(action.targetId).transition(props,function(){prx.callbackAction(action)})},action.delay);break;default:new TimelineMax().to(action.targetId,options.duration/1000,{left:props.left,top:props.top,ease:options.easing,delay:action.delay/1000}).call(options.complete);break}break;case"move-to":props.top=true;props.left=true;var _target=$(action.targetId);if(action.moveXTo!="*"){var x=Number(action.moveXTo);props.left=x}if(action.moveYTo!="*"){var y=Number(action.moveYTo);props.top=y}switch(animEngine){case"Transit":setTimeout(function(){$(action.targetId).transition(props,function(){prx.callbackAction(action)})},action.delay);break;default:if(action.moveXTo!="*"){props.left=props.left-parseInt($(action.targetId).css("left"))}if(action.moveYTo!="*"){props.top=props.top-parseInt($(action.targetId).css("top"))}new TimelineMax().to(action.targetId,options.duration/1000,{x:props.left,y:props.top,ease:options.easing,delay:action.delay/1000}).call(options.complete);break}break;case"move-to-animation-target":var x=true;var y=true;if(action.pageId!=-1){var $ap=$("#p-"+action.pageId+"-"+action.animationPointId)}else{var $ap=$("#"+action.containerid+"-"+action.animationPointId)}x=$ap.position().left;y=$ap.position().top;x=x-parseInt($(action.targetId).css("left"));y=y-parseInt($(action.targetId).css("top"));switch(animEngine){case"Transit":setTimeout(function(){$(action.targetId).transition({left:x,top:y,easing:action.animationEasing,duration:action.duration,queue:false},function(){prx.callbackAction(action)})},action.delay);break;default:new TimelineMax().to(action.targetId,options.duration/1000,{x:x,y:y,ease:options.easing,delay:parseInt(action.delay)/1000}).call(options.complete);break}break;default:break}break;case"resize-item":props.scale=1;switch(action.resizeType){case"resize-by":if(action.resizeXBy!="*"){var x=Number(action.resizeXBy);if(x>=0){x="+="+x}else{x="-="+-x}props.width=x}if(action.resizeYBy!="*"){var y=Number(action.resizeYBy);if(y>=0){y="+="+y}else{y="-="+-y}props.height=y}switch(animEngine){case"Transit":setTimeout(function(){$(action.targetId).transition(props,function(){if(typeof(prx.scroller[action.targetId.substring(1)+"-inner"])!="undefined"){prx.scroller[action.targetId.substring(1)+"-inner"].refresh()}prx.callbackAction(action)})},action.delay);break;default:options.complete=function(){if(typeof(prx.scroller[action.targetId.substring(1)+"-inner"])!="undefined"){prx.scroller[action.targetId.substring(1)+"-inner"].refresh()}prx.callbackAction(action)};new TimelineMax().to(action.targetId,options.duration/1000,{width:props.width,height:props.height,ease:options.easing,delay:action.delay/1000}).call(options.complete);break}break;case"resize-to":props.width=true;props.height=true;if(action.resizeXTo!="*"){var x=Number(action.resizeXTo);props.width=x}if(action.resizeYTo!="*"){var y=Number(action.resizeYTo);props.height=y}switch(animEngine){case"Transit":setTimeout(function(){$(action.targetId).transition(props,function(){if(typeof(prx.scroller[action.targetId.substring(1)+"-inner"])!="undefined"){prx.scroller[action.targetId.substring(1)+"-inner"].refresh()}prx.callbackAction(action)})},action.delay);break;default:options.complete=function(){if(typeof(prx.scroller[action.targetId.substring(1)+"-inner"])!="undefined"){prx.scroller[action.targetId.substring(1)+"-inner"].refresh()}prx.callbackAction(action)};new TimelineMax().to(action.targetId,options.duration/1000,{width:props.width,height:props.height,ease:options.easing,delay:action.delay/1000}).call(options.complete);break}break;default:break}break;case"scale-item":var x=Number(action.scaleX);var y=Number(action.scaleY);switch(animEngine){case"Transit":setTimeout(function(){$(action.targetId).transition({scale:[x,y],easing:action.animationEasing,duration:action.duration,queue:false},function(){prx.callbackAction(action)})},action.delay);break;default:new TimelineMax().to(action.targetId,options.duration/1000,{scaleX:x,scaleY:y,ease:options.easing,delay:action.delay/1000}).call(options.complete);break}break;case"fade-item":switch(animEngine){case"Transit":setTimeout(function(){$(action.targetId).transition({opacity:Number(action.fadeTo),easing:action.animationEasing,duration:action.duration,queue:false},function(){prx.callbackAction(action)})},action.delay);break;default:new TimelineMax().to(action.targetId,options.duration/1000,{autoAlpha:Number(action.fadeTo),ease:options.easing,delay:action.delay/1000}).call(options.complete);break}break;case"rotate-item":switch(action.rotateType){case"rotate-by":var deg=Number(action.rotateBy);if(deg>=0){deg="+="+deg}else{deg="-="+-deg}switch(animEngine){case"Transit":setTimeout(function(){$(action.targetId).transition({rotate:deg,easing:action.animationEasing,duration:action.duration,queue:false},function(){prx.callbackAction(action)})},action.delay);break;default:new TimelineMax().to(action.targetId,options.duration/1000,{rotation:deg,ease:options.easing,delay:action.delay/1000}).call(options.complete);break}break;case"rotate-to":switch(animEngine){case"Transit":setTimeout(function(){$(action.targetId).transition({rotate:Number(action.rotateTo),easing:action.animationEasing,duration:action.duration,queue:false},function(){prx.callbackAction(action)})},action.delay);break;default:new TimelineMax().to(action.targetId,options.duration/1000,{rotation:Number(action.rotateTo),ease:options.easing,delay:action.delay/1000}).call(options.complete);break}break;default:break}break;default:break}};prx.actionMoveScreen=function(action){var animEngine=prx.defaultAnimEngine;if(action.animationEasing.substring(0,12)=="cubic-bezier"){animEngine="Transit"}switch(animEngine){case"Transit":var props={easing:action.animationEasing,duration:action.duration,queue:false};break;default:var props={};var options={duration:parseInt(action.duration),easing:action.animationEasing,queue:false,complete:function(){prx.callbackAction(action)}};action.animationEasing=prx.easingTransitToTweenMax[action.animationEasing];break}switch(action.moveType){case"move-by":props.top=true;props.left=true;if(action.moveXBy!="*"){var x=Number(action.moveXBy);if(x>=0){x="+="+x}else{x="-="+-x}props.left=x}if(action.moveYBy!="*"){var y=Number(action.moveYBy);var pageid=action.targetId.split("-")[1];if(prx.statusbars[pageid].statusbar==1){y+=prx.devices[prx.device]["statusbarheight"+prx.statusbars[pageid].orientation]}if(y>=0){y="+="+y}else{y="-="+-y}props.top=y}switch(animEngine){case"Transit":setTimeout(function(){$(action.targetId).transition(props,function(){prx.callbackAction(action)})},action.delay);break;default:new TimelineMax().to(action.targetId,options.duration/1000,{left:props.left,top:props.top,ease:options.easing,delay:action.delay/1000}).call(options.complete);break}break;case"move-to":props.top=true;props.left=true;if(action.moveXTo!="*"){var x=Number(action.moveXTo);props.left=x}if(action.moveYTo!="*"){var y=Number(action.moveYTo);var pageid=action.targetId.split("-")[1];if(prx.statusbars[pageid].statusbar==1){y+=prx.devices[prx.device]["statusbarheight"+prx.statusbars[pageid].orientation]}props.top=y}switch(animEngine){case"Transit":setTimeout(function(){$(action.targetId).transition(props,function(){prx.callbackAction(action)})},action.delay);break;default:new TimelineMax().to(action.targetId,options.duration/1000,{left:props.left,top:props.top,ease:options.easing,delay:action.delay/1000}).call(options.complete);break}break;default:break}};prx.actionChangeProperty=function(action){var _duration=1;var _delay=0;if(typeof(action.duration)!="undefined"){_duration=action.duration/1000}if(typeof(action.delay)!="undefined"){_delay=action.delay/1000}var _property;if(typeof(action._timelineToUse)!="undefined"){var timeline=action._timelineToUse}else{var timeline=new TimelineMax()}var propertyType=action.propertyType;if(typeof(propertyType)=="undefined"){propertyType="component-property"}switch(action.propertyId){case"left":case"top":case"opacity":_property={selector:"",property:action.propertyId};break;case"width":case"height":_property={selector:"",property:action.propertyId};if(typeof(action.componentType)!="undefined"&&typeof(prx.types[action.componentType].onResize)!="undefined"){_property.onResize=prx.types[action.componentType].onResize}break;case"templatestateid":_property={property:"template-state"};break;case"background":if(action.itemId=="current-page"||action.itemId=="current-page-template"||action.itemId=="current-container"){_property={type:"colorpicker",selector:"",property:"background-color"};break}case"dynamicProperties":_property={rerender:true};break;case"visible":_property={selector:"",property:"opacity"};break;case"draggable":_property={rerender:true};break;default:switch(propertyType){case"component-property":if(typeof(prx.types[action.componentType].editableProperties)!="undefined"){for(var i=0;i<prx.types[action.componentType].editableProperties.length;i++){if(prx.types[action.componentType].editableProperties[i].name==action.propertyId){_property=prx.types[action.componentType].editableProperties[i].changeProperty;_property.type=prx.types[action.componentType].editableProperties[i].type;break}}}if(typeof(_property)=="undefined"){if(typeof(prx.types[action.componentType].interactions)!="undefined"){for(var i=0;i<prx.types[action.componentType].interactions.length;i++){if(prx.types[action.componentType].interactions[i].name==action.propertyId){_property={property:"action"};break}}}}if(typeof(_property)=="undefined"){if(typeof(prx.types[action.componentType].propertyGroups)!="undefined"){for(var i=0;i<prx.types[action.componentType].propertyGroups.length;i++){for(var j=0;j<prx.types[action.componentType].propertyGroups[i].properties.length;j++){for(var k=0;k<prx.types[action.componentType].propertyGroups[i].properties[j].length;k++){if(prx.types[action.componentType].propertyGroups[i].properties[j][k].name==action.propertyId){_property=prx.types[action.componentType].propertyGroups[i].properties[j][k].changeProperty;_property.type=prx.types[action.componentType].propertyGroups[i].properties[j][k].type;break}}}}}}break;case"dynamic-property":if(typeof(prx.types[action.componentType].dynamicProperties)!="undefined"){if(typeof(prx.types[action.componentType].dynamicProperties.editableProperties)!="undefined"){for(var i=0;i<prx.types[action.componentType].dynamicProperties.editableProperties.length;i++){if(prx.types[action.componentType].dynamicProperties.editableProperties[i].name==action.propertyId){_property=prx.types[action.componentType].dynamicProperties.editableProperties[i].changeProperty;_property.type=prx.types[action.componentType].dynamicProperties.editableProperties[i].type;break}}}if(typeof(_property)=="undefined"){if(typeof(prx.types[action.componentType].dynamicProperties.interactions)!="undefined"){for(var i=0;i<prx.types[action.componentType].dynamicProperties.interactions.length;i++){if(prx.types[action.componentType].dynamicProperties.interactions[i].name==action.propertyId){_property={property:"action"};break}}}}if(typeof(_property)=="undefined"){if(typeof(prx.types[action.componentType].dynamicProperties.propertyGroups)!="undefined"){for(var i=0;i<prx.types[action.componentType].dynamicProperties.propertyGroups.length;i++){for(var j=0;j<prx.types[action.componentType].dynamicProperties.propertyGroups[i].properties.length;j++){for(var k=0;k<prx.types[action.componentType].dynamicProperties.propertyGroups[i].properties[j].length;k++){if(prx.types[action.componentType].dynamicProperties.propertyGroups[i].properties[j][k].name==action.propertyId){_property=prx.types[action.componentType].dynamicProperties.propertyGroups[i].properties[j][k].changeProperty;_property.type=prx.types[action.componentType].dynamicProperties.propertyGroups[i].properties[j][k].type;break}}}}}}}break}break}switch(action.valueType){case"customValue":break;case"readFromVariable":if(typeof(action.variableName!="undefined")){if(typeof(prx.variables[action.variableName])!="undefined"){if(typeof(prx.variables[action.variableName].parsed)=="undefined"){prx.recursiveEvaluation(prx.variables[action.variableName].value,action.variableName)}action.newvalue=prx.variables[action.variableName].parsed}}break}if(typeof(_property)!="undefined"){if(typeof(_property.property)!="undefined"){switch(_property.property){case"text":switch(propertyType){case"component-property":timeline.add(function(){$(action.targetId+" "+_property.selector).text(action.newvalue);prx.callbackAction(action)},_delay);break;case"dynamic-property":timeline.add(function(){$(action.targetId+' [data-dynamic-property-index="'+action.itemIndex+'"] '+_property.selector).text(action.newvalue);prx.callbackAction(action)},_delay);break}break;case"input-value":timeline.add(function(){$(action.targetId+" "+_property.selector).val(action.newvalue);prx.callbackAction(action)},_delay);break;case"action":var oldvalue=action.oldvalue;var newvalue=action.newvalue;(function(oldvalue,newvalue,timeline){timeline.add(function(){var item={type:action.componentType,id:action.itemId};if(action.propertyType=="dynamic-property"){item[prx.types[action.componentType].dynamicProperties.data]=[];item[prx.types[action.componentType].dynamicProperties.data][action.itemIndex]={};if(this.timeline.data.reversing){item[prx.types[action.componentType].dynamicProperties.data][action.itemIndex][action.propertyId]=oldvalue}else{item[prx.types[action.componentType].dynamicProperties.data][action.itemIndex][action.propertyId]=newvalue}}else{if(this.timeline.data.reversing){item[action.propertyId]=oldvalue}else{item[action.propertyId]=newvalue}}prx.parseItemAction(item,action.containerid,action.pageId);prx.callbackAction(action)},_delay)})(oldvalue,newvalue,timeline);if(typeof(action._timelineToUse)!="undefined"){return timeline}break;case"container-state":var action2={_timelineToUse:timeline,pageId:action.pageId,targetId:action.targetId,stateId:action.newvalue,itemId:action.itemId};setTimeout(function(){prx.actionChangeState(action2,"symbols")},action.delay);break;case"template-state":var action2={_timelineToUse:timeline,pageId:action.pageId,targetId:action.targetId,stateId:action.newvalue,itemId:action.itemId,delay:action.delay};setTimeout(function(){prx.actionChangeState(action2,"templates")},action.delay);break;case"width":case"height":_onComplete=function(){var targetId=action.targetId;if(targetId.indexOf("-scroll")!=-1){targetId=targetId.substring(0,targetId.indexOf("-scroll"))}if(typeof(prx.scroller[targetId.substring(1)+"-inner"])!="undefined"){prx.scroller[targetId.substring(1)+"-inner"].refresh()}prx.callbackAction(action)};case"border-width":case"border-radius":if(parseInt(action.newvalue)==action.newvalue){action.newvalue+="px"}case"opacity":if(parseFloat(action.newvalue)==action.newvalue){action.newvalue=parseFloat(action.newvalue)}default:var _transition={};switch(_property.type){case"colorpicker":case"combo-colorpicker":action.newvalue=getColor(action.newvalue);break;default:break}var _onComplete=function(){prx.callbackAction(action)};_transition[_property.property.replace(/-([a-z])/g,function(m,w){return w.toUpperCase()})]=action.newvalue;if(typeof(action.animationEasing)!="undefined"){_transition.ease=prx.easingTransitToTweenMax[action.animationEasing]}else{_transition.ease=prx.easingTransitToTweenMax.linear}var selector=action.targetId+" "+_property.selector+", "+action.targetId+_property.selector;if(propertyType=="dynamic-property"){selector=action.targetId+' [data-dynamic-property-index="'+action.itemIndex+'"] '+_property.selector}_transition.immediateRender=false;timeline.add(TweenLite.to(selector,_duration,_transition),_delay);timeline.add(_onComplete,(_duration+_delay));if(typeof(action._timelineToUse)!="undefined"){return timeline}return}}if(_property.rerender){var item;var stateid=$(".box[id$="+action.itemId+"]").parents("[data-state-id]").first().attr("data-state-id");if(typeof(prx.allItems[action.itemId].states)!="undefined"&&typeof(prx.allItems[action.itemId].states[stateid])!="undefined"){var data=$.evalJSON(prx[prx.allItems[action.itemId].containertype][prx.allItems[action.itemId].containerindex].states[prx.allItems[action.itemId].states[stateid].stateindex].data);if(typeof(data.items)!="undefined"){item=data.items[prx.allItems[action.itemId].itemindex]}else{item=data[prx.allItems[action.itemId].states[stateid].itemindex]}}if(typeof(item)=="undefined"){timeline.add(function(){prx.callbackAction(action)});return false}item[action.propertyId]=action.newvalue;timeline.add(function(){prx.rerenderItem(item,action.containerid,action.pageId);prx.callbackAction(action)},_delay)}}if(typeof(action._timelineToUse)!="undefined"){return timeline}};prx.actionSetVariable=function(action){var _duration=1;var _delay=0;if(typeof(action.duration)!="undefined"){_duration=action.duration/1000}if(typeof(action.delay)!="undefined"){_delay=action.delay/1000}var _property;var propertyType=action.propertyType;if(typeof(propertyType)=="undefined"){propertyType="component-property"}switch(action.valueSource){case"customValue":break;case"callbackvalue":_property={selector:"",property:"triggerdata"};break;case"setValueFromItemProperty":switch(action.propertyId){case"left":case"top":case"opacity":_property={selector:"",property:action.propertyId};break;case"width":case"height":_property={selector:"",property:action.propertyId};if(typeof(prx.types[action.componentType].onResize)!="undefined"){_property.onResize=prx.types[action.componentType].onResize}break;default:switch(propertyType){case"component-property":if(typeof(prx.types[action.componentType].editableProperties)!="undefined"){for(var i=0;i<prx.types[action.componentType].editableProperties.length;i++){if(prx.types[action.componentType].editableProperties[i].name==action.propertyId){_property=prx.types[action.componentType].editableProperties[i].changeProperty;_property.type=prx.types[action.componentType].editableProperties[i].type;break}}}if(typeof(_property)=="undefined"){if(typeof(prx.types[action.componentType].interactions)!="undefined"){for(var i=0;i<prx.types[action.componentType].interactions.length;i++){if(prx.types[action.componentType].interactions[i].name==action.propertyId){_property={property:"action"};break}}}}if(typeof(_property)=="undefined"){if(typeof(prx.types[action.componentType].propertyGroups)!="undefined"){for(var i=0;i<prx.types[action.componentType].propertyGroups.length;i++){for(var j=0;j<prx.types[action.componentType].propertyGroups[i].properties.length;j++){for(var k=0;k<prx.types[action.componentType].propertyGroups[i].properties[j].length;k++){if(prx.types[action.componentType].propertyGroups[i].properties[j][k].name==action.propertyId){_property=prx.types[action.componentType].propertyGroups[i].properties[j][k].changeProperty;_property.type=prx.types[action.componentType].propertyGroups[i].properties[j][k].type;break}}}}}}break;case"dynamic-property":if(typeof(prx.types[action.componentType].dynamicProperties)!="undefined"){if(typeof(prx.types[action.componentType].dynamicProperties.editableProperties)!="undefined"){for(var i=0;i<prx.types[action.componentType].dynamicProperties.editableProperties.length;i++){if(prx.types[action.componentType].dynamicProperties.editableProperties[i].name==action.propertyId){_property=prx.types[action.componentType].dynamicProperties.editableProperties[i].changeProperty;_property.type=prx.types[action.componentType].dynamicProperties.editableProperties[i].type;break}}}if(typeof(_property)=="undefined"){if(typeof(prx.types[action.componentType].dynamicProperties.interactions)!="undefined"){for(var i=0;i<prx.types[action.componentType].dynamicProperties.interactions.length;i++){if(prx.types[action.componentType].dynamicProperties.interactions[i].name==action.propertyId){_property={property:"action"};break}}}}if(typeof(_property)=="undefined"){if(typeof(prx.types[action.componentType].dynamicProperties.propertyGroups)!="undefined"){for(var i=0;i<prx.types[action.componentType].dynamicProperties.propertyGroups.length;i++){for(var j=0;j<prx.types[action.componentType].dynamicProperties.propertyGroups[i].properties.length;j++){for(var k=0;k<prx.types[action.componentType].dynamicProperties.propertyGroups[i].properties[j].length;k++){if(prx.types[action.componentType].dynamicProperties.propertyGroups[i].properties[j][k].name==action.propertyId){_property=prx.types[action.componentType].dynamicProperties.propertyGroups[i].properties[j][k].changeProperty;_property.type=prx.types[action.componentType].dynamicProperties.propertyGroups[i].properties[j][k].type;break}}}}}}}break}break}break}var _tempSelector="";if(typeof(_property)!="undefined"){if(typeof(_property.property)!="undefined"){switch(propertyType){case"component-property":_tempSelector=$(action.targetId+" "+_property.selector);break;case"dynamic-property":_tempSelector=$(action.targetId+' [data-dynamic-property-index="'+action.itemIndex+'"] '+_property.selector);break}switch(_property.property){case"text":action.newvalue=_tempSelector.text();break;case"input-value":action.newvalue=_tempSelector.val();break;case"width":action.newvalue=_tempSelector.width();break;case"height":action.newvalue=_tempSelector.height();break;case"left":action.newvalue=_tempSelector.position().left;break;case"top":action.newvalue=_tempSelector.position().top;break;case"triggerdata":if(typeof(prx.triggerData[action.bindTo])!="undefined"){if(typeof(prx.triggerData[action.bindTo][action.type])!="undefined"){if(typeof(prx.triggerData[action.bindTo][action.type][action.callbackvariable])!="undefined"){action.newvalue=prx.triggerData[action.bindTo][action.type][action.callbackvariable]}else{action.newvalue=null}}else{action.newvalue=null}}break;default:break}}}setTimeout(function(){if(typeof(action.variableName!="undefined")){if(typeof(prx.variables[action.variableName])!="undefined"){prx.variables[action.variableName].value=prx.recursiveEvaluation(action.newvalue,action.variableName,true)}}prx.callbackAction(action)},action.delay)};prx.rerenderItem=function(item,containerid,pageid){if(typeof(prx.types[item.type])!="undefined"){if(typeof(prx.types[item.type].onDisplay)!="undefined"){var $olditem=$(".box[id$="+item.id+"]").attr("id",$(".box[id$="+item.id+"]").attr("id")+"-to-be-removed");$olditem.after(prx.types[item.type].onDisplay(item,containerid,pageid));$olditem.remove();if(typeof(item._fromstateid)!="undefined"){item.opacity=0;$(".box[id$="+item.id+"]").addClass("ghost-component")}prx.updateItemVisibility(item,containerid);prx.updateItemPosition(item,containerid,pageid);if(typeof(prx.types[item.type])!="undefined"){if(typeof(prx.types[item.type].afterDisplay)!="undefined"){prx.types[item.type].afterDisplay(item,containerid,pageid)}}prx.parseItemAction(item,containerid,pageid);prx.makeDraggable(item,pageid)}}};prx.actionChangeState=function(action,type){if(action.pageId==-1){action.pageId=action.containerid.split("-")[1]}var pageId=action.pageId;var tostateid=action.stateId;var reverse=false;var targetId=action.targetId;var startfromtime=0;prx.setActionIsRunningFalse(action);switch(type){case"pages":var index=prx.getPageIndexFromId(pageId);var objToChange="#p-"+pageId;break;case"templates":var pageindex=prx.getPageIndexFromId(pageId);if(pageindex==-1){return false}var index=prx.getTemplateIndexFromId(prx.pages[pageindex].states[0].template.id);targetId=action.targetId+"-t"+ +prx.pages[pageindex].states[0].template.id;var objToChange=targetId;break;case"symbols":var symbolid=-1;var itemId=action.itemId;if(itemId==-1||(itemId.match(/box/g)||[]).length>1){var split=action.targetId.split("box-");itemId="box-"+split[split.length-1]}for(var stateid in prx.allItems[itemId].states){if(prx.allItems[itemId].states.hasOwnProperty(stateid)){var data=$.evalJSON(prx[prx.allItems[itemId].containertype][prx.allItems[itemId].containerindex].states[prx.allItems[itemId].states[stateid].stateindex].data);symbolid=data[prx.allItems[itemId].states[stateid].itemindex].symbolid;break}}if(symbolid==-1){return false}var index=prx.getSymbolIndexFromId(symbolid);var objToChange=action.targetId;break}if(index==-1){return false}$(objToChange).trigger("stateleave");var fromstateid=$(objToChange).attr("data-state-id");switch(tostateid){case"previous-state":for(var i=0;i<prx[type][index].states.length;i++){if(prx[type][index].states[i].id==fromstateid){if(i==0){return false}else{tostateid=prx[type][index].states[i-1].id}break}}break;case"next-state":for(var i=0;i<prx[type][index].states.length;i++){if(prx[type][index].states[i].id==fromstateid){if(i==prx[type][index].states.length-1){return false}else{tostateid=prx[type][index].states[i+1].id}break}}break;case"first-state":tostateid=prx[type][index].states[0].id;break;case"last-state":tostateid=prx[type][index].states[prx[type][index].states.length-1].id;break;default:break}if(tostateid==fromstateid){if(typeof($(objToChange).attr("data-previous-state-id"))!="undefined"){fromstateid=$(objToChange).attr("data-previous-state-id")}}$(objToChange).attr("data-state-id",tostateid).attr("data-previous-state-id",fromstateid);if(typeof(prx[type][index].state_transitions_reverse)!="undefined"&&typeof(prx[type][index].state_transitions_reverse[fromstateid+":"+tostateid])!="undefined"&&prx[type][index].state_transitions_reverse[fromstateid+":"+tostateid]){reverse=true;if(typeof(prx.stateTimelines[objToChange+"-"+tostateid+":"+fromstateid])!="undefined"&&prx.stateTimelines[objToChange+"-"+tostateid+":"+fromstateid].length>0){var time=prx.stateTimelines[objToChange+"-"+tostateid+":"+fromstateid][prx.stateTimelines[objToChange+"-"+tostateid+":"+fromstateid].length-1].time();var totaltime=prx.stateTimelines[objToChange+"-"+tostateid+":"+fromstateid][0].totalDuration();startfromtime=totaltime-time}reverse=true}var changes=prx.getChangesBetweenStates(fromstateid,tostateid,type,index);var fromstate=prx[type][index].states[prx.getStateIndexFromId(fromstateid,type,index)].data;if(changes!=false){var _canvastype=type;var _index=index;var duration,delay,easing,commonduration,commondelay,commoneasing;var common={};var allchanges={};var maxendtotal=0;if(reverse){var state_transitions=prx[_canvastype][_index].state_transitions[tostateid+":"+fromstateid]}else{if(typeof(prx[_canvastype][_index].state_transitions)!="undefined"&&typeof(prx[_canvastype][_index].state_transitions[fromstateid+":"+tostateid])!="undefined"){var state_transitions=prx[_canvastype][_index].state_transitions[fromstateid+":"+tostateid]}}for(var i=0;i<changes.length;i++){commonduration=0;commondelay=0;commoneasing="linear";var minstart=9999;var maxend=0;if(typeof(state_transitions)!="undefined"&&typeof(state_transitions[changes[i].id])!="undefined"){if(typeof(state_transitions[changes[i].id].common)!="undefined"){if(typeof(state_transitions[changes[i].id].common.delay)!="undefined"){commondelay=state_transitions[changes[i].id].common.delay}if(typeof(state_transitions[changes[i].id].common.duration)!="undefined"){commonduration=state_transitions[changes[i].id].common.duration}if(typeof(state_transitions[changes[i].id].common.easing)!="undefined"){commoneasing=state_transitions[changes[i].id].common.easing}minstart=commondelay;maxend=commondelay+commonduration}}if(typeof(changes[i].changes)!="undefined"){for(var key in changes[i].changes){if(changes[i].changes.hasOwnProperty(key)){var elm=changes[i].changes[key];var itemType=changes[i].componentType;var transitionable=true;var rerender=false;var found=false;delay=commondelay;duration=commonduration;easing=commoneasing;if(typeof(state_transitions)!="undefined"&&typeof(state_transitions[changes[i].id])!="undefined"){if(typeof(state_transitions[changes[i].id][key])!="undefined"){if(typeof(state_transitions[changes[i].id][key].delay)!="undefined"){delay=state_transitions[changes[i].id][key].delay}if(typeof(state_transitions[changes[i].id][key].duration)!="undefined"){duration=state_transitions[changes[i].id][key].duration}if(typeof(state_transitions[changes[i].id][key].easing)!="undefined"){easing=state_transitions[changes[i].id][key].easing}}}if(changes[i].type=="new-component"||changes[i].type=="removed-component"){if(key=="opacity"){allchanges[changes[i].id+"-"+key]={duration:duration,delay:parseFloat(delay)+0.001,easing:easing,transitionable:true,rerender:false}}continue}if(changes[i].id=="current-page"||changes[i].id=="current-page-template"||changes[i].id=="current-container"){allchanges[changes[i].id+"-"+key]={duration:duration,delay:delay,easing:easing,transitionable:true,rerender:false};continue}if(key=="dynamicProperties"){allchanges[changes[i].id+"-"+key]={duration:0,delay:false,easing:easing,transitionable:false,rerender:true};continue}if(key=="visible"){allchanges[changes[i].id+"-"+key]={duration:duration,delay:delay,easing:easing,transitionable:true,rerender:false};continue}if(key.indexOf("dynamicProperties-")>-1){var tosearch=prx.types[itemType].dynamicProperties;var split=key.split("-");var keytosearch=split[split.length-1]}else{var tosearch=prx.types[itemType];var keytosearch=key}if(typeof(tosearch.editableProperties)!="undefined"){for(var j=0;j<tosearch.editableProperties.length;j++){if(tosearch.editableProperties[j].name==keytosearch){if(typeof(tosearch.editableProperties[j].changeProperty)!="undefined"){if(typeof(tosearch.editableProperties[j].changeProperty.transitionable)!="undefined"){transitionable=tosearch.editableProperties[j].changeProperty.transitionable}if(typeof(tosearch.editableProperties[j].changeProperty.rerender)!="undefined"){rerender=tosearch.editableProperties[j].changeProperty.rerender}found=true;break}}}}if(!found){if(typeof(tosearch.interactions)!="undefined"){for(var j=0;j<tosearch.interactions.length;j++){if(tosearch.interactions[j].name==keytosearch){if(typeof(tosearch.interactions[j].changeProperty)!="undefined"){caption=tosearch.interactions[j].changeProperty.caption;if(typeof(tosearch.interactions[j].changeProperty.transitionable)!="undefined"){transitionable=tosearch.interactions[j].changeProperty.transitionable}if(typeof(tosearch.interactions[j].changeProperty.rerender)!="undefined"){rerender=tosearch.interactions[j].changeProperty.rerender}found=true;break}}}}}if(!found){if(typeof(tosearch.propertyGroups)!="undefined"){for(var j=0;j<tosearch.propertyGroups.length;j++){for(var k=0;k<tosearch.propertyGroups[j].properties.length;k++){for(var l=0;l<tosearch.propertyGroups[j].properties[k].length;l++){if(tosearch.propertyGroups[j].properties[k][l].name==keytosearch){if(typeof(tosearch.propertyGroups[j].properties[k][l].changeProperty)!="undefined"){if(typeof(tosearch.propertyGroups[j].properties[k][l].changeProperty.transitionable)!="undefined"){transitionable=tosearch.propertyGroups[j].properties[k][l].changeProperty.transitionable}if(typeof(tosearch.propertyGroups[j].properties[k][l].changeProperty.rerender)!="undefined"){rerender=tosearch.propertyGroups[j].properties[k][l].changeProperty.rerender}found=true;break}}}}}}}if(!transitionable){duration=0}if(rerender){duration=0;delay=false}allchanges[changes[i].id+"-"+key]={duration:duration,delay:delay,easing:easing,transitionable:transitionable,rerender:rerender};minstart=(delay<minstart)?delay:minstart;maxend=((delay+duration)>maxend)?delay+duration:maxend}}}if(minstart==9999){minstart=0}commonduration=maxend-minstart;commondelay=minstart;common["changed-"+changes[i].id]={duration:commonduration,delay:commondelay,easing:commoneasing};if(commonduration+commondelay>maxendtotal){maxendtotal=commonduration+commondelay}}if(reverse){for(var key in allchanges){if(allchanges.hasOwnProperty(key)){if(allchanges[key].delay!==false){allchanges[key].delay=maxendtotal-(allchanges[key].delay+allchanges[key].duration)}allchanges[key].easing=prx.easingTransitToTweenMaxReverse[allchanges[key].easing]}}for(var key in common){if(common.hasOwnProperty(key)){common[key].delay=maxendtotal-(common[key].delay+common[key].duration);common[key].easing=prx.easingTransitToTweenMaxReverse[common[key].easing]}}}for(var key in allchanges){if(allchanges.hasOwnProperty(key)){if(allchanges[key].delay===false){var commonkey="changed-"+key.split("-")[0]+"-"+key.split("-")[1];allchanges[key].delay=common[commonkey].duration+common[commonkey].delay}}}if(typeof(action._timelineToUse)!="undefined"){var timeline=action._timelineToUse}else{var timeline=new TimelineMax({paused:true})}for(var i=0;i<changes.length;i++){switch(changes[i].type){case"new-component":(function(i){prx.rerenderItem(changes[i].item,targetId.slice(1),pageId);timeline.add(function(){if(!this.timeline.data.reversing){$(targetId+"-"+changes[i].id).removeClass("ghost-component")}else{$(targetId+"-"+changes[i].id).addClass("ghost-component")}},0)})(i);break;case"removed-component":var delay=common["changed-"+changes[i].id].delay;var duration=common["changed-"+changes[i].id].duration;(function(i,delay,duration){timeline.add(function(){if(!this.timeline.data.reversing){$(targetId+"-"+changes[i].id).addClass("ghost-component")}else{$(targetId+"-"+changes[i].id).removeClass("ghost-component")}},delay+duration)})(i,delay,duration);break;case"changed-component":case"container-properties":case"page-properties":case"template-properties":break;case"reordered-components":(function(i){timeline.add(function(){var t=this;if(!t.timeline.data.reversing){components=changes[i].new_order.split(",")}else{components=changes[i].old_order.split(",")}for(var j=1;j<components.length;j++){$(targetId+"-"+components[j]).insertAfter(targetId+"-"+components[j-1])}},maxendtotal)})(i);default:break}if(typeof(changes[i].changes)!="undefined"){$.each(changes[i].changes,function(key,elm){if(typeof(allchanges[changes[i].id+"-"+key])!="undefined"){var delay=allchanges[changes[i].id+"-"+key].delay;var duration=allchanges[changes[i].id+"-"+key].duration;switch(changes[i].id){case"current-page":var targetId2=targetId;break;case"current-container":var targetId2=targetId+"-scroll";break;default:var targetId2=targetId+"-"+changes[i].id;break}if(key=="visible"){if(elm[1]==0){(function(i,delay,duration){timeline.add(function(){$(targetId+"-"+changes[i].id).addClass("hidden")},delay+duration)})(i,delay,duration)}else{(function(i){timeline.add(function(){$(targetId+"-"+changes[i].id).removeClass("hidden")},delay)})(i);$(targetId+"-"+changes[i].id).css("opacity",0);delay=delay+0.001}}var action2={_timelineToUse:timeline,pageId:pageId,itemId:changes[i].id,targetId:targetId2,containerid:targetId.slice(1),componentType:changes[i].componentType,propertyId:key,newvalue:elm[1],oldvalue:elm[0],duration:duration*1000,delay:delay*1000};if(key.indexOf("dynamicProperties-")>-1){var split=key.split("-");action2.propertyType="dynamic-property";action2.itemIndex=split[1];action2.propertyId=split[split.length-1]}timeline=prx.actionChangeProperty(action2)}})}}timeline.add(function(){if(!this.timeline.data.reversing){$(objToChange).trigger("stateenter")}},0.001);timeline.add(function(){if(typeof(this.timeline.data.suppressEvents)=="undefined"||!this.timeline.data.suppressEvents){if(!this.timeline.data.reversing){$(objToChange).trigger("statetransitionstart")}else{$(objToChange).trigger("statetransitionend")}}},minstart);if(minstart==0){minstart=0.0012}timeline.add(function(){if(typeof(this.timeline.data.suppressEvents)=="undefined"||!this.timeline.data.suppressEvents){if(!this.timeline.data.reversing){$(objToChange).trigger("statetransitionend")}else{$(objToChange).trigger("statetransitionstart")}}},maxendtotal);timeline.data={reversing:false};if(typeof(prx.stateTimelines[objToChange+"-"+fromstateid+":"+tostateid])=="undefined"){prx.stateTimelines[objToChange+"-"+fromstateid+":"+tostateid]=[]}else{if(prx.stateTimelines[objToChange+"-"+fromstateid+":"+tostateid].length>1){for(var i=prx.stateTimelines[objToChange+"-"+fromstateid+":"+tostateid].length-1;i>0;i--){prx.stateTimelines[objToChange+"-"+fromstateid+":"+tostateid][i].kill();prx.stateTimelines[objToChange+"-"+fromstateid+":"+tostateid].splice(i,1)}}}timeline.eventCallback("onComplete",function(){if(typeof(this.data.suppressEvents)=="undefined"||!this.data.suppressEvents){if($(targetId).attr("data-state-id")==tostateid){prx.callbackAction(action)}}});prx.stateTimelines[objToChange+"-"+fromstateid+":"+tostateid].push(timeline);if(reverse&&startfromtime!=0){var action2={pageId:pageId,itemId:(type=="pages")?"page-transition":itemId,targetId:objToChange,stateTransition:"all-transitions",endTransition:false};prx.actionStopStateTransition(action2)}timeline.seek(timeline.totalDuration()).play(startfromtime)}};prx.actionStopStateTransition=function(action){if(action.pageId==-1){action.pageId=action.containerid.split("-")[1]}var type="pages";var index=prx.getPageIndexFromId(action.pageId);switch(action.itemId){case"page-transition":type="pages";index=prx.getPageIndexFromId(action.pageId);action.targetId="#p-"+action.pageId;break;case"-1":return false;break;default:var symbolid=prx.recursivelyFindItemSymbolId(action.itemId,type,index);if(!symbolid){return[]}type="symbols";index=prx.getSymbolIndexFromId(symbolid);break}var stateids=[];if(action.stateTransition=="all-transitions"){for(var i=0;i<prx[type][index].states.length;i++){stateids.push(prx[type][index].states[i].id)}}else{stateids.push(action.stateTransition)}for(var transition in prx.stateTimelines){if(prx.stateTimelines.hasOwnProperty(transition)){for(var i=0;i<stateids.length;i++){if(transition.indexOf(action.targetId)>-1&&transition.indexOf(stateids[i])>-1){for(var j=0;j<prx.stateTimelines[transition].length;j++){if(action.endTransition){if(typeof(prx.stateTimelines[transition][j].data)=="undefined"){prx.stateTimelines[transition][j].data={}}prx.stateTimelines[transition][j].data.suppressEvents=true;prx.stateTimelines[transition][j].seek(prx.stateTimelines[transition][j].totalDuration(),false)}prx.stateTimelines[transition][j].pause()}}}}}prx.callbackAction(action)};prx.buildAction=function(action,clicktotap,bindevents){if(typeof(action.enabled)!="undefined"&&!action.enabled){return false}if(typeof(bindevents)=="undefined"){bindevents=true}if(typeof(action.live)=="undefined"){action.live=false}if(typeof(action.delay)=="undefined"){action.delay=0}if(action.type=="containerpageenter"&&typeof(action.namespace)=="undefined"){action.namespace=".page"+action.eventItemIndex[0]+"-"+action.eventItemIndex[1]}if(typeof(action.namespace)=="undefined"){action.namespace=""}action.namespace+=".protoio";if(typeof(action.guid)=="undefined"){action.guid=getGuid()}if(typeof(action.callback)=="undefined"){action.callback=false}clicktotap=true;if(typeof(action.targetId)=="undefined"){if(typeof(action.pageId)!="undefined"){action.targetId="#p-"+action.pageId+"-"+action.itemId}else{action.targetId=(action.itemId==-1)?"#"+action.containerid:"#"+action.containerid+"-"+action.itemId;if(action.itemId==-1){var split=action.containerid.split("-");action.itemId="box-"+split[split.length-1]}}}if(typeof(action.pageId)!="undefined"){if(action.pageId==-1){if(typeof(action.itemId)!="undefined"&&action.itemId!=null&&typeof(action.containerid)!="undefined"&&action.containerid!=null&&action.itemId.split("-").shift()==action.containerid.split("-").pop()){action.targetId="#"+action.containerid+"-"+action.itemId.split("-").slice(1).join("-")}else{action.targetId=(action.itemId==-1)?"#"+action.containerid:"#"+action.containerid+"-"+action.itemId;if(action.itemId==-1){var split=action.containerid.split("-");action.itemId="box-"+split[split.length-1]}}}else{if(action.pageId==-2){var split=action.targetId.split("-");action.targetId="#p-"+split[1];action.pageId=split[1]}else{if(typeof(action.allowOverwriteTargetId)=="undefined"||action.allowOverwriteTargetId){if(typeof(action.itemId)!="undefined"){action.targetId="#p-"+action.pageId+"-"+action.itemId}else{action.targetId="#p-"+action.pageId}}}}}else{}action.guid=action.targetId+"-"+action.guid;if(action.animation==""){action.animation="none"}if(clicktotap){if(action.type=="click"){action.type="tap"}}if(action.type=="taphold"){action.type="hold"}if(bindevents){if(action.live){$(document).off(action.type+action.namespace+"."+action.guid.replace(/-/g,"").replace("#",""),action.bindTo);$(document).hammer().on(action.type+action.namespace+"."+action.guid.replace(/-/g,"").replace("#",""),action.bindTo,function(event,a){if(prx.actionIsRunning[action.guid]==false){try{_activePage=$.mobile.activePage.get(0).id}catch(err){_activePage=+$(".ui-page-active").first().attr("id")}if(action.type=="click"||action.type=="tap"){var target=event.target;while(target!=null&&target.nodeType==1){if(typeof(prx.scroller[target.id])!="undefined"){if(prx.scroller[target.id].moved){return false}else{break}}target=target.parentNode}}if(typeof(event.gesture)=="undefined"&&event.type=="tap"){return false}if(action.type!="keydown"||action.type=="keydown"&&event.which==action.charCode&&_activePage==action.bindPageId&&!(/textarea|select|input/i.test(event.target.nodeName))){prx.actions[action.guid].call(this,event,a);if(action.type=="keydown"){return false}}}})}else{$(action.bindTo).hammer({tap_always:false}).on(action.type+action.namespace,function(event,a){if(prx.actionIsRunning[action.guid]==true){return false}try{_activePage=$.mobile.activePage.get(0).id}catch(err){_activePage=$(".ui-page-active").first().attr("id")}if(action.type=="click"||action.type=="tap"){var target=event.target;while(target!=null&&target.nodeType==1){if(typeof(prx.scroller[target.id])!="undefined"){if(prx.scroller[target.id].moved){return false}else{break}}target=target.parentNode}}if(action.type!="keydown"||action.type=="keydown"&&event.which==action.charCode&&_activePage==action.bindPageId&&!(/textarea|select|input/i.test(event.target.nodeName))){prx.actions[action.guid].call(this,event,a);if(action.type=="keydown"){return false}}})}}prx.actionIsRunning[action.guid]=false;prx.generateActionFunction(action);if(action.callback){if(action.loop){action.callbackAction.loop=action.loop;if(typeof(action.loopGUID)!="undefined"){action.callbackAction.loopGUID=action.loopGUID}else{action.callbackAction.loopGUID=action.guid}}if(typeof(action.previousActions)=="undefined"){action.previousActions=[]}if(typeof(action.containerid)!="undefined"){action.callbackAction.containerid=action.containerid}action.callbackAction.previousActions=action.previousActions;action.callbackAction.previousActions.push(action.guid);prx.buildAction(action.callbackAction,undefined,false)}return true};prx.generateActionFunction=function(action){prx.actions[action.guid]=function(event,a){if(typeof(event)!="undefined"){if(event.type=="stateenter"||event.type=="stateleave"||event.type=="statetransitionstart"||event.type=="statetransitionend"){if(event.target!=event.currentTarget){return false}}}if(!prx.actionIsRunning[action.guid]&&action.loop&&typeof(action.loopIterations)!="undefined"){prx.actionLoopCounter[action.guid]=action.loopIterations-1}prx.actionIsRunning[action.guid]=true;if(typeof(event)!="undefined"){event.stopPropagation();if(action.type=="tap"){event.preventDefault();$(this).find("input[type=radio], input[type=checkbox]").not(":visible").attr("checked","checked")}}switch(action.actionId){case"alert":alert(action.bindTo);prx.callbackAction(action);break;case"alert-variable":alert(prx.readVariable(action.variable));prx.callbackAction(action);break;case"stoppropagation":prx.callbackAction(action);break;case"go-to-page":prx.actionGoToPage(action);break;case"load-page":prx.actionLoadPage(action);break;case"unload-page":prx.actionUnloadPage(action);break;case"hide-item":prx.actionHideItem(action);break;case"show-item":prx.actionShowItem(action);break;case"show-hide-item":if(typeof(action.duration)=="undefined"){action.duration=200}prx.actionShowItem(action);setTimeout(function(){prx.actionHideItem(action)},action.duration);break;case"toggle-item":prx.actionToggleItem(action);break;case"highlight-navbar-item":setTimeout(function(){if(action.itemIndex=="-1"){$(action.targetId+" input[type=radio]").removeAttr("checked")}else{var _itemid=action.targetId+"-radio-"+action.itemIndex;$("[id="+_itemid.substr(1)+"]").attr("checked",true)}prx.callbackAction(action)},action.delay);break;case"highlight-list-item":setTimeout(function(){if(action.itemIndex=="-1"){$(action.targetId+" input[type=radio]").removeAttr("checked")}else{var _itemid=action.targetId+"-checkbox-"+action.itemIndex;$(_itemid).attr("checked",true)}prx.callbackAction(action)},action.delay);break;case"highlight-pagecontroller-item":setTimeout(function(){if(action.itemIndex=="-1"){$(action.targetId+" input[type=radio]").removeAttr("checked")}else{$(action.targetId+" input").eq(parseInt(action.itemIndex)).attr("checked","checked")}prx.callbackAction(action)},action.delay);break;case"play-audio":setTimeout(function(){$(action.targetId+" audio").get(0).play();prx.callbackAction(action)},action.delay);break;case"pause-audio":setTimeout(function(){$(action.targetId+" audio").get(0).pause();prx.callbackAction(action)},action.delay);break;case"stop-audio":setTimeout(function(){$(action.targetId+" audio").get(0).pause();$(action.targetId+" audio").get(0).currentTime=0;prx.callbackAction(action)},action.delay);break;case"play-video":setTimeout(function(){$(action.targetId+" video").get(0).play();prx.callbackAction(action)},action.delay);break;case"pause-video":setTimeout(function(){$(action.targetId+" video").get(0).pause();prx.callbackAction(action)},action.delay);break;case"stop-video":setTimeout(function(){$(action.targetId+" video").get(0).pause();$(action.targetId+" video").get(0).currentTime=0;prx.callbackAction(action)},action.delay);break;case"go-to-carousel-page":prx.actionGoToCarouselPage(action);break;case"scroll-scrollable-container":prx.actionScrollScrollableContainer(action);break;case"sync-pagecontroller-item":var _page=0;if($(action.targetId).hasClass("type-pagecontroller-vertical")){_page=a.currentPage.pageY}else{_page=a.currentPage.pageX}setTimeout(function(){$(action.targetId+" input:eq("+_page+")").attr("checked","checked");prx.callbackAction(action)},action.delay);break;case"fire-item-event":prx.actionFireItemEvent(action);break;case"animate-item":prx.actionAnimateItem(action);break;case"end-loop":setTimeout(function(){var actionGuid=action.actionGuid;if(typeof(prx.actions[actionGuid])=="undefined"){actionGuid=action.containerid+"-"+action.actionGuid}prx.actionLoopCounter[actionGuid]=0;prx.callbackAction(action)},action.delay);break;case"change-property":prx.actionChangeProperty(action);break;case"set-variable":prx.actionSetVariable(action);break;case"move-screen":prx.actionMoveScreen(action);break;case"change-screen-state":setTimeout(function(){prx.actionChangeState(action,"pages")},action.delay);break;case"change-template-state":setTimeout(function(){prx.actionChangeState(action,"templates")},action.delay);break;case"go-to-container-state":case"change-container-state":setTimeout(function(){prx.actionChangeState(action,"symbols")},action.delay);break;case"stop-state-transition":setTimeout(function(){prx.actionStopStateTransition(action)},action.delay);break;default:break}}};prx.callbackAction=function(action){if(action.callback){prx.actions[action.callbackAction.guid].call()}else{if(typeof(action.loop)!="undefined"&&action.loop){var loopGuid=(typeof(action.loopGUID)!="undefined")?action.loopGUID:action.guid;if(prx.actionLoopCounter[loopGuid]>0){prx.actionLoopCounter[loopGuid]--;prx.actions[loopGuid].call()}else{prx.actionIsRunning[loopGuid]=false}}else{prx.setActionIsRunningFalse(action)}}};prx.setActionIsRunningFalse=function(action){if(typeof(action.guid)!="undefined"){prx.actionIsRunning[action.guid]=false;if(typeof(action.previousActions)!="undefined"){for(var i=0;i<action.previousActions.length;i++){prx.actionIsRunning[action.previousActions[i]]=false}}}};prx.preLoadPage=function(_page){var _data=prx.getAllPageItems(prx.getPageIndexFromId(_page.id));var _orientation=prx.getPageOrientation(_page);var _OrientationWidth=0;var _OrientationHeight=0;var _actualPageHeight=0;_OrientationWidth=prx.devices[prx.device][_orientation][0];_OrientationHeight=prx.devices[prx.device][_orientation][1];_actualPageHeight=_OrientationHeight;$("#dragarea").width(_OrientationWidth);var _currentPage=$("#p-"+_page.id).attr("data-state-id",_page.states[0].id);_currentPage.width(_OrientationWidth);_currentPage.css("height",_OrientationHeight+"px");_currentPage.unbind("pageshow").bind("pageshow",function(event,ui){_currentPage.height(_OrientationHeight);$(".remove-on-pageshow").removeClass("remove-on-pageshow").removeClass("ui-page-active");$.each($("#p-"+_page.id+" .type-picker, #p-"+_page.id+" .type-picker-retina, .type-android-scrollable-tabbar"),function(i,elm){if(typeof(prx.scroller[elm.id+"-inner"])!="undefined"){prx.scroller[elm.id+"-inner"].refresh()}});if(!prx.embed&&parent!=window){try{parent.prx.highlightPage(_page.id)}catch(err){}}$("#overlay").empty().hide();return false});if(_page.navigationbar=="undefined"){_page.navigationbar="0"}prx.statusbars[_page.id]={};prx.statusbars[_page.id].statusbar=_page.statusbar;prx.statusbars[_page.id].orientation=_orientation;var _deviceOrientation=($(window).width()<$(window).height())?"portrait":"landscape";if(typeof(_page.navigationbar)=="undefined"){_page.navigationbar="0"}prx.navigationbars[_page.id]={};prx.navigationbars[_page.id].navigationbar=_page.navigationbar;prx.navigationbars[_page.id].orientation=_orientation;if(_page.orientation==_deviceOrientation){var _startscreen=(_deviceOrientation=="portrait")?prx.project.startscreen:prx.project.startscreenlandscape;if(_page.statusbar=="1"){if(prx.allowstatusbar){try{if(_startscreen==_page.id){if(prx.export2html!="1"){$("#statusbar").css({"background-image":prx.buildStatusBarAsset(_orientation)})}else{if(prx.statusbarapplies=="1"){$("#statusbar").css("background-image","url(./images/statusbar_"+_orientation+".png)")}else{$("#statusbar").css("background-image","none")}}$("#statusbar").css("height",prx.devices[prx.device]["statusbarheight"+_orientation]+"px")}_currentPage.css("top",prx.devices[prx.device]["statusbarheight"+_orientation]+"px")}catch(err){}}_actualPageHeight=_actualPageHeight-prx.devices[prx.device]["statusbarheight"+_orientation]}if(_page.navigationbar=="1"){if(prx.allownavigationbar){try{if(_startscreen===_page.id){if(prx.export2html!="1"){$("#navigationbar").css({"background-image":prx.buildNavigationBarAsset(_orientation)})}else{if(prx.navigationbarapplies=="1"){$("#navigationbar").css("background-image","url(./images/navigationbar_"+_orientation+".png)")}else{$("#statusbar").css("background-image","none")}}}$("#navigationbar").css("height",prx.devices[prx.device]["navigationbarheight"+_orientation]+"px");$("#navigationbar").css("top",prx.devices[prx.device][_orientation][1]-prx.devices[prx.device]["navigationbarheight"+_orientation]+"px")}catch(err){}}_actualPageHeight=_actualPageHeight-prx.devices[prx.device]["navigationbarheight"+_orientation]}}$("#dragarea").height(_actualPageHeight);if(typeof(_page.states[0].background)=="undefined"){_page.states[0].background="none"}if(_page.states[0].background!="none"){_currentPage.css("background-color",getColor(_page.states[0].background))}if(_page.states[0].template.id.length>0){var index=prx.getTemplateIndexFromId(_page.states[0].template.id);var stateindex=prx.getTemplateStateIndexFromId(_page.states[0].template.stateid,index);if(index>-1&&stateindex>-1){var containerid="";var _cTemplate=prx.renderTemplate(_page.states[0].template.id,containerid,_page.id,_page.states[0].template.stateid);_currentPage.append('<div id="p-'+_page.id+'-template" style="position: absolute; left: 0px; top: 0px; background: none; width: '+_OrientationWidth+"px; height: "+_actualPageHeight+'px;">'+_cTemplate+"</div>");_cTemplate=null;if(typeof(prx.templates[index].states[stateindex].background)=="undefined"){prx.templates[index].states[stateindex].background="none"}if(_page.background=="none"&&prx.templates[index].states[stateindex].background!="none"){_currentPage.css("background-color",getColor(prx.templates[index].states[stateindex].background))}var _dataFromTemplate=$.evalJSON(prx.templates[index].states[stateindex].data);var _items=_dataFromTemplate;var _templateid=prx.templates[index].states[stateindex].template.id;prx.loadRecursiveTemplateAfterDisplay(_page.states[stateindex].template,containerid,_page.id);_dataFromTemplate=null;_items=null}else{_data.templateid=""}}$.each(_data,function(i,item){prx.addItem(_page.id,item,i)});prx.loadPageEvents(_page.id);prx.loadRecursiveTemplateEvents(_page.states[0].template,_page.id)};prx.loadRecursiveTemplateEvents=function(template,pageid,containerid){if(typeof(containerid)=="undefined"){containerid=""}prx.loadTemplateEvents(template,pageid,containerid);var index=prx.getTemplateIndexFromId(template.id);var stateindex=prx.getTemplateStateIndexFromId(template.stateid,index);if(index>-1&&stateindex>-1){var _tempdata=$.evalJSON(prx.templates[index].states[stateindex].data);var _templateid=prx.templates[index].states[stateindex].template.id;if(_templateid!=undefined){if(eval(_templateid)>-1){if(containerid.length==0){containerid="t"+_templateid}else{containerid="-t"+_templateid}prx.loadRecursiveTemplateEvents(prx.templates[index].states[stateindex].template,pageid,containerid)}}_tempdata=null}return true};prx.loadRecursiveTemplateAfterDisplay=function(template,containerid,pageid){var index=prx.getTemplateIndexFromId(template.id);var stateindex=prx.getTemplateStateIndexFromId(template.stateid,index);var templateid=template.id;var _containerid="";if(typeof(containerid)=="undefined"){containerid="p-"+pageid+"-"}else{if(containerid.length==0){containerid="p-"+pageid+"-"}else{containerid=containerid+"-"}_containerid=containerid+"t"+templateid}if(index>-1&&stateindex>-1){var _tempdata=$.evalJSON(prx.templates[index].states[stateindex].data);var _template=prx.templates[index].states[stateindex].template;var _items=_tempdata;for(var n=0;n<_items.length;n++){var tempitem=_items[n];if(typeof(tempitem._fromstateid)!="undefined"){tempitem.opacity=0;$(".box[id$="+tempitem.id+"]").addClass("ghost-component")}prx.updateItemVisibility(tempitem,_containerid);prx.updateItemPosition(tempitem,_containerid,pageid);if(typeof(prx.types[tempitem.type])!="undefined"){if(typeof(prx.types[tempitem.type].afterDisplay)!="undefined"){prx.types[tempitem.type].afterDisplay(tempitem,_containerid,pageid)}}prx.makeDraggable(tempitem,pageid,_containerid)}if(typeof(prx.templates[index].states[stateindex].background)=="undefined"){prx.templates[index].states[stateindex].background="none"}if(($("#p-"+pageid).css("background-color")=="transparent"||$("#p-"+pageid).css("background-color")=="rgba(0, 0, 0, 0)")&&prx.templates[index].states[stateindex].background!="none"){$("#p-"+pageid).css("background-color",getColor(prx.templates[index].states[stateindex].background))}if(_template.id!=undefined){if(eval(_template.id)>-1){prx.loadRecursiveTemplateAfterDisplay(_template,_containerid,pageid)}}_tempdata=null;_items=null}return true};prx.clearDragArea=function(){$("#dragarea").html("")};prx.renderTemplate=function(templateid,containerid,pageid,stateid){var index=prx.getTemplateIndexFromId(templateid);var stateindex=0;if(typeof(stateid)=="undefined"){stateid=prx.templates[index].states[0].id}stateindex=prx.getTemplateStateIndexFromId(stateid,index);var _cR="";var _containerid="";if(typeof(containerid)=="undefined"){containerid="p-"+pageid+"-"}else{if(containerid.length==0){containerid="p-"+pageid+"-"}else{containerid=containerid+"-"}_containerid=containerid+"t"+templateid}_cR='<div id="'+_containerid+'" data-state-id='+stateid+">";if(index>-1&&stateindex>-1){var _tempdata=$.evalJSON(prx.templates[index].states[stateindex].data);var _items=_tempdata;var _templateid=prx.templates[index].states[stateindex].template.id;if(_templateid!=undefined){if(eval(_templateid)>-1){_cR=_cR+prx.renderTemplate(_templateid,_containerid,pageid,prx.templates[index].states[stateindex].template.stateid)}}for(var n=0;n<_items.length;n++){var tempitem=_items[n];if(typeof(prx.types[tempitem.type])!="undefined"){if(typeof(prx.types[tempitem.type].onDisplayTemplate)!="undefined"){_cR=_cR+prx.types[tempitem.type].onDisplayTemplate(tempitem,_containerid)}else{_cR=_cR+prx.types[tempitem.type].onDisplay(tempitem,_containerid)}}}}_cR=_cR+"</div>";return _cR};prx.addItem=function(pageid,item,index){var zIndex;if(!item.zindex){item.zindex=zIndex+1}if(!item.hpos){item.hpos="left"}if(!item.vpos){item.vpos="top"}if(!item.wtype){item.wtype="fixed"}if(!item.htype){item.htype="fixed"}if(!item.opacity){item.opacity="1"}var tempitem=item;item=[item];var _containerid="p-"+pageid;if(typeof(prx.types[tempitem.type])!="undefined"){if(typeof(prx.types[tempitem.type].onDisplay)!="undefined"){$("#p-"+pageid).append(prx.types[tempitem.type].onDisplay(tempitem,_containerid))}}if(typeof(tempitem._fromstateid)!="undefined"){tempitem.opacity=0;$(".box[id$="+tempitem.id+"]").addClass("ghost-component")}prx.updateItemVisibility(tempitem,_containerid);prx.updateItemPosition(tempitem,_containerid,pageid);if(typeof(prx.types[tempitem.type])!="undefined"){if(typeof(prx.types[tempitem.type].afterDisplay)!="undefined"){prx.types[tempitem.type].afterDisplay(tempitem,_containerid,pageid)}}prx.makeDraggable(tempitem,pageid)};prx.makeDraggable=function(item,pageid,containerid){if(typeof(item.draggable)!="undefined"){if(item.draggable.isdraggable){var gridWidth=0,gridHeight=0,gridRows=0,gridColumns=0,_snap={};_bounds="";if(item.draggable.isdraggable){var _targetid="";if(typeof(containerid)=="undefined"){_targetid="#p-"+pageid+"-"+item.id}else{if(containerid.length==0){_targetid="#p-"+pageid+"-"+item.id}else{_targetid="#"+containerid+"-"+item.id}}item.draggable.targetitem=$(_targetid);if(item.draggable.snap){gridRows=item.draggable.snapprops.rows;gridColumns=item.draggable.snapprops.columns}if(item.draggable.bounds=="auto"){item.draggable.container=item.draggable.targetitem.parent();if(item.draggable.snap){gridWidth=item.draggable.container.width()/gridColumns;gridHeight=item.draggable.container.height()/gridRows}if(item.width<gridWidth){gridWidth=(item.draggable.container.width()-item.width)/gridColumns;gridHeight=(item.draggable.container.height()-item.height)/gridRows}}else{var _parentPosition=item.draggable.targetitem.parent().offset();item.draggable.container={left:parseInt(item.draggable.boundsprops.left)+_parentPosition.left,top:parseInt(item.draggable.boundsprops.top)+_parentPosition.top,width:item.draggable.boundsprops.width,height:item.draggable.boundsprops.height};if(item.draggable.snap){gridWidth=item.draggable.boundsprops.width/gridColumns;gridHeight=item.draggable.boundsprops.height/gridRows}}if(typeof(item.draggable.handle)!="undefined"&&item.draggable.handle!=""){item.draggable.handleid=_targetid+"-"+item.draggable.handle}if(typeof(item.draggable.front)=="undefined"){item.draggable.front=false}if(typeof(item.draggable.livesnap)=="undefined"){item.draggable.livesnap=false}var _snap,_maxDuration;if(item.draggable.kinetic){_maxDuration=2}else{_maxDuration=0.0001}if(item.draggable.snap){if(item.draggable.axis!="rotation"){_snap={x:function(endValue){if(item.draggable.snap){return Math.max(this.minX,Math.min(this.maxX,Math.round(endValue/gridWidth)*gridWidth))}else{return endValue}},y:function(endValue){if(item.draggable.snap){return Math.max(this.minY,Math.min(this.maxY,Math.round(endValue/gridHeight)*gridHeight))}else{return endValue}}}}else{_snap=function(endValue){var _rotationSnap=item.draggable.rotationsnap;return Math.round(endValue/_rotationSnap)*_rotationSnap}}}var _tempRotated=0;if(item.draggable.axis!="rotation"){_bounds=item.draggable.container}else{if(item.draggable.rotationbounds=="none"){_bounds={minRotation:-99999,maxRotation:99999}}else{_bounds={minRotation:parseInt(item.draggable.boundsprops.mindegrees),maxRotation:parseInt(item.draggable.boundsprops.maxdegrees)}}}Draggable.create(item.draggable.targetitem,{type:item.draggable.axis,zIndexBoost:false,edgeResistance:0.95,throwProps:true,bounds:_bounds,trigger:(typeof(item.draggable.handleid)!="undefined")?item.draggable.handleid:"",zIndexBoost:item.draggable.front,snap:_snap,dragResistance:0,maxDuration:_maxDuration,liveSnap:item.draggable.livesnap,onDragStart:function(){var _r={};if(item.draggable.axis!="rotation"){_r.row=0;_r.column=0;_r.x=0;_r.y=0;_r.movex=0;_r.movey=0;_r.left=0;_r.top=0;_r.position={left:item.left,top:item.top};if(item.draggable.snap){switch(item.draggable.axis){case"x":_r.row=1;_r.column=Math.round((this.endX-this.minX)/gridWidth)+1;break;case"y":_r.row=Math.round((this.endY-this.minY)/gridHeight)+1;_r.column=1;break;case"x,y":_r.row=Math.round((this.endY-this.minY)/gridHeight)+1;_r.column=Math.round((this.endX-this.minX)/gridWidth)+1;break;default:break}}_r.x=Math.round(this.endX-this.minX);_r.y=Math.round(this.endY-this.minY);_r.movex=this.x;_r.movey=this.y;_r.left=Math.round($(this.target).offset().left);_r.top=Math.round($(this.target).offset().top);prx.triggerData[_targetid]={};prx.triggerData[_targetid]["ondragstart"]=_r;$(_targetid).trigger("ondragstart",this)}else{_r.degrees=Math.abs(Math.round((this.endRotation%360)));_r.rotationposition=this.endRotation;if(isNaN(_r.degrees)){_r.degrees=0}_tempRotated=this.x;_r.rotated=0;prx.triggerData[_targetid]={};prx.triggerData[_targetid]["onrotatestart"]=_r;$(_targetid).trigger("onrotatestart",this)}},onDrag:function(){var _r={};if(item.draggable.axis!="rotation"){_r.row=0;_r.column=0;_r.x=0;_r.y=0;_r.movex=0;_r.movey=0;_r.left=0;_r.top=0;if(item.draggable.snap){switch(item.draggable.axis){case"x":_r.row=1;_r.column=Math.round((this.endX-this.minX)/gridWidth)+1;break;case"y":_r.row=Math.round((this.endY-this.minY)/gridHeight)+1;_r.column=1;break;case"x,y":_r.row=Math.round((this.endY-this.minY)/gridHeight)+1;_r.column=Math.round((this.endX-this.minX)/gridWidth)+1;break;default:break}}_r.x=Math.round(this.endX-this.minX);_r.y=Math.round(this.endY-this.minY);_r.movex=this.x;_r.movey=this.y;_r.left=Math.round($(this.target).offset().left);_r.top=Math.round($(this.target).offset().top);prx.triggerData[_targetid]["ondrag"]=_r;$(_targetid).trigger("ondrag",this)}else{_r.degrees=Math.abs(Math.round((this.endX%360)));_r.rotationposition=this.endX;_r.rotated=this.endX-_tempRotated;_r.rotated=Math.round(_r.rotated);prx.triggerData[_targetid]["onrotate"]=_r;$(_targetid).trigger("onrotate",this)}},onDragEnd:function(){var _r={};if(item.draggable.axis!="rotation"){_r.row=0;_r.column=0;_r.x=0;_r.y=0;_r.movex=0;_r.movey=0;_r.left=0;_r.top=0;if(item.draggable.snap){switch(item.draggable.axis){case"x":_r.row=1;_r.column=Math.round((this.endX-this.minX)/gridWidth)+1;break;case"y":_r.row=Math.round((this.endY-this.minY)/gridHeight)+1;_r.column=1;break;case"x,y":_r.row=Math.round((this.endY-this.minY)/gridHeight)+1;_r.column=Math.round((this.endX-this.minX)/gridWidth)+1;break;default:break}}_r.x=Math.round(this.endX-this.minX);_r.y=Math.round(this.endY-this.minY);_r.movex=this.x;_r.movey=this.y;_r.left=Math.round($(this.target).offset().left);_r.top=Math.round($(this.target).offset().top);prx.triggerData[_targetid]["ondragend"]=_r;$(_targetid).trigger("ondragend",this)}else{_r.degrees=Math.abs(Math.round((this.endX%360)));_r.rotationposition=this.endX;_r.rotated=this.endX-_tempRotated;_r.rotated=Math.round(_r.rotated);prx.triggerData[_targetid]["onrotateend"]=_r;$(_targetid).trigger("onrotateend",this)}},onThrowUpdate:function(){var _r={};if(item.draggable.axis!="rotation"){_r.row=0;_r.column=0;_r.x=0;_r.y=0;_r.movex=0;_r.movey=0;if(item.draggable.snap){switch(item.draggable.axis){case"x":_r.row=1;_r.column=Math.round((this.endX-this.minX)/gridWidth)+1;break;case"y":_r.row=Math.round((this.endY-this.minY)/gridHeight)+1;_r.column=1;break;case"x,y":_r.row=Math.round((this.endY-this.minY)/gridHeight)+1;_r.column=Math.round((this.endX-this.minX)/gridWidth)+1;break;default:break}}_r.x=Math.round(this.endX-this.minX);_r.y=Math.round(this.endY-this.minY);_r.movex=Math.round(this.x);_r.movey=Math.round(this.y);_r.left=Math.round($(this.target).offset().left);_r.top=Math.round($(this.target).offset().top);prx.triggerData[_targetid]["onthrowupdate"]=_r;$(_targetid).trigger("onthrowupdate",this)}else{_r.degrees=Math.abs(Math.round((this.endX%360)));_r.rotationposition=this.endX;_r.rotated=Math.round(_r.rotated);prx.triggerData[_targetid]["onrotatethrowupdate"]=_r;$(_targetid).trigger("onrotatethrowupdate",this)}},onThrowComplete:function(){var _r={};if(item.draggable.axis!="rotation"){_r.row=0;_r.column=0;_r.x=0;_r.y=0;_r.movex=0;_r.movey=0;if(item.draggable.snap){switch(item.draggable.axis){case"x":_r.row=1;_r.column=Math.round((this.endX-this.minX)/gridWidth)+1;break;case"y":_r.row=Math.round((this.endY-this.minY)/gridHeight)+1;_r.column=1;break;case"x,y":_r.row=Math.round((this.endY-this.minY)/gridHeight)+1;_r.column=Math.round((this.endX-this.minX)/gridWidth)+1;break;default:break}}_r.x=Math.round(this.endX-this.minX);_r.y=Math.round(this.endY-this.minY);_r.movex=Math.round(this.x);_r.movey=Math.round(this.y);_r.left=Math.round($(this.target).offset().left);_r.top=Math.round($(this.target).offset().top);prx.triggerData[_targetid]["onthrowcomplete"]=_r;$(_targetid).trigger("onthrowcomplete",this)}else{_r.degrees=Math.abs(Math.round((this.endX%360)));_r.rotationposition=this.endX;_r.rotated=this.endX-_tempRotated;_r.rotated=Math.round(_r.rotated);prx.triggerData[_targetid]["onrotatethrowcomplete"]=_r;$(_targetid).trigger("onrotatethrowcomplete",this)}}})}}}};prx.renderSymbol=function(item,containerid,stateindex){var _cR="";var pageid;if(typeof(stateindex)=="undefined"){stateindex=0}var index=prx.getSymbolIndexFromId(item.symbolid);var _containerid="";_containerid=containerid+"-"+item.id;var _symbol_width="100%";var _symbol_height="100%";if(item.scroll!=""){if(item.scroll=="horizontal"||item.scroll=="omni"){_symbol_width=prx.symbols[prx.getSymbolIndexFromId(item.symbolid)].states[stateindex].dimensions[0]+"px"}if(item.scroll=="vertical"||item.scroll=="omni"){_symbol_height=prx.symbols[prx.getSymbolIndexFromId(item.symbolid)].states[stateindex].dimensions[1]+"px"}}if(index>-1){var _items=prx.getAllSymbolItems(index,stateindex);for(var n=0;n<_items.length;n++){var tempitem=_items[n];if(typeof(tempitem._fromstateid)!="undefined"){tempitem.opacity=0}if(typeof(prx.types[tempitem.type])!="undefined"){if(typeof(prx.types[tempitem.type].onDisplaySymbol)!="undefined"){_cR=_cR+prx.types[tempitem.type].onDisplaySymbol(tempitem,_containerid,pageid,item)}else{_cR=_cR+prx.types[tempitem.type].onDisplay(tempitem,_containerid,pageid,item)}}}}return _cR};prx.getAllItems=function(type,index,stateindex){if(typeof(stateindex)=="undefined"){stateindex=0}var data=$.evalJSON(prx[type][index].states[stateindex].data);if(prx[type][index].states.length==1){return data}var itemlist=[];var tempdata;for(var i=0;i<data.length;i++){itemlist.push(data[i].id)}for(i=0;i<prx[type][index].states.length;i++){if(i!=stateindex){tempdata=$.evalJSON(prx[type][index].states[i].data);for(var j=0;j<tempdata.length;j++){if(itemlist.indexOf(tempdata[j].id)==-1){itemlist.push(tempdata[j].id);tempdata[j]._fromstateid=prx[type][index].states[i].id;data.push(tempdata[j])}}}}return data};prx.getAllPageItems=function(index,stateindex){return prx.getAllItems("pages",index,stateindex)};prx.getAllTemplateItems=function(index,stateindex){return prx.getAllItems("templates",index,stateindex)};prx.getAllSymbolItems=function(index,stateindex){return prx.getAllItems("symbols",index,stateindex)};prx.loadRecursiveSymbolAfterDisplay=function(item,containerid,pageid,stateindex){if(typeof(stateindex)=="undefined"){stateindex=0}var index=prx.getSymbolIndexFromId(item.symbolid);var _containerid="";if(typeof(item.scrollsnap)=="undefined"){item.scrollsnap=false}if(typeof(containerid)=="undefined"){_containerid="p-"+pageid+"-"}else{if(containerid.length==0){containerid="p-"+pageid+"-"}else{containerid=containerid+"-"}_containerid=containerid+item.id}if(index>-1){var _items=prx.getAllSymbolItems(index,stateindex);for(var n=0;n<_items.length;n++){var tempitem=_items[n];if(typeof(tempitem._fromstateid)!="undefined"){tempitem.opacity=0;$(".box[id$="+tempitem.id+"]").addClass("ghost-component")}prx.updateItemVisibility(tempitem,_containerid);prx.updateSymbolItemPosition(tempitem,_containerid,pageid,item);if(typeof(prx.types[tempitem.type].afterDisplay)!="undefined"){prx.types[tempitem.type].afterDisplay(tempitem,_containerid,pageid)}prx.makeDraggable(tempitem,pageid,_containerid);prx.parseItemAction(tempitem,_containerid,pageid,"",true)}for(var j=0;j<prx.symbols[index].states.length;j++){prx.parseSymbolStateAction(index,j,pageid,_containerid,item.id)}prx.iniScrollContainer(item,_containerid)}$("#p-"+pageid).unbind("pageshow.protoio-forscrollers").bind("pageshow.protoio-forscrollers",function(event,ui){$("#p-"+pageid+" .box").each(function(){if(typeof(prx.scroller[this.id+"-inner"])!="undefined"){prx.scroller[this.id+"-inner"].refresh()}})});return true};prx.iniScrollContainer=function(item,_containerid){if(typeof(prx.scroller[_containerid+"-inner"])!="undefined"){delete prx.scroller[_containerid+"-inner"]}if(typeof(item.scroll)!="undefined"){if(item.scroll!=""){var _scrollX=false;var _scrollY=false;var _scrollbars=false;var _snap=eval(item.scrollsnap);switch(item.scroll){case"omni":_scrollX=true;_scrollY=true;_scrollbars=(eval(item.hscrollbar)||eval(item.vscrollbar))?true:false;break;case"horizontal":_scrollX=true;_scrollbars=(eval(item.hscrollbar))?true:false;break;case"vertical":_scrollY=true;_scrollbars=(eval(item.vscrollbar))?true:false;break;default:break}if($.isArray(_snap)){_snap=true}if(typeof(prx.scroller[_containerid+"-inner"])=="undefined"){if(typeof(item.lockdirection)=="undefined"){item.lockdirection=true}if(typeof(item.bounce)=="undefined"){item.bounce=true}prx.scroller[_containerid+"-inner"]=new IScroll("#"+_containerid+"-inner",{scrollX:_scrollX,scrollY:_scrollY,snap:_snap,useTransition:true,click:true,zoom:eval(item.pinchzoom),momentum:eval(item.momentum),bounce:item.bounce,bounceLock:true,lockDirection:eval(item.lockdirection),scrollbars:_scrollbars,mouseWheel:true,probeType:3});prx.scroller[_containerid+"-inner"].on("scroll",function(){var _targetid=_containerid+"-inner";var _triggerId="#"+_containerid;var _r={};prx.triggerData[_triggerId]={};if(eval(item.scrollsnap)){_r.x=this.currentPage.x;_r.y=this.currentPage.y;_r.currentpagex=this.currentPage.pageX+1;_r.currentpagey=this.currentPage.pageY+1;_r.currentpagexindex=this.currentPage.pageX;_r.currentpageyindex=this.currentPage.pageY;prx.triggerData[_triggerId]["containerscroll"]=_r;$("#"+_containerid).trigger("containerscroll",this)}else{_r.x=this.x;_r.y=this.y;_r.currentpagex=1;_r.currentpagey=1;_r.currentpagexindex=0;_r.currentpageyindex=0;prx.triggerData[_triggerId]["containerscroll"]=_r;$("#"+_containerid).trigger("containerscroll",this)}});prx.scroller[_containerid+"-inner"].on("scrollEnd",function(){var _targetid=_containerid+"-inner";var _triggerId="#"+_containerid;var _r={};prx.triggerData[_triggerId]={};if(eval(item.scrollsnap)){_r.x=this.currentPage.x;_r.y=this.currentPage.y;_r.currentpagex=this.currentPage.pageX+1;_r.currentpagey=this.currentPage.pageY+1;_r.currentpagexindex=this.currentPage.pageX;_r.currentpageyindex=this.currentPage.pageY;prx.triggerData[_triggerId]["containerpagechange"]=_r;prx.triggerData[_triggerId]["containerpageenter"]=_r;prx.triggerData[_triggerId]["containerscrollend"]=_r;$("#"+_containerid).trigger("containerpagechange",this);$("#"+_containerid).trigger("containerpageenter.page"+this.currentPage.pageX+"-"+this.currentPage.pageY,this);$("#"+_containerid).trigger("containerscrollend",this)}else{_r.x=this.x;_r.y=this.y;_r.currentpagex=1;_r.currentpagey=1;_r.currentpagexindex=0;_r.currentpageyindex=0;prx.triggerData[_triggerId]["containerscrollend"]=_r;$("#"+_containerid).trigger("containerscrollend",this)}});for(var i=0;i<prx.scrollableTabbars.length;i++){var _linked=prx.scrollableTabbars[i].container+"-"+prx.scrollableTabbars[i].linked+"-inner";if(_linked==_containerid+"-inner"){var _tabbar=prx.scrollableTabbars[i].container+"-"+prx.scrollableTabbars[i].id+"-inner";prx.scroller[_linked].options.linkedTabbar=_tabbar;prx.scroller[_linked].goToPage(Number(prx.scrollableTabbars[i].start),0,0);if(typeof(prx.scroller[_tabbar])!="undefined"){prx.scroller[_tabbar].goToPage(Number(prx.scrollableTabbars[i].start),0,0)}prx.scroller[_linked].on("scroll",function(){prx.scroller[this.options.linkedTabbar].scrollTo(this.x/2,0,0,false)});prx.scroller[_linked].on("scrollEnd",function(){prx.scroller[this.options.linkedTabbar].goToPage(this.currentPage.pageX,0,200)})}}}}}};prx.updateItemVisibility=function(item,containerid){var _item="";if(typeof(containerid)!="undefined"){_item=$("#"+containerid+"-"+item.id)}else{_item=$("#"+item.id)}if(typeof(item.visible)!="undefined"){if(!item.visible){_item.addClass("hidden")}else{_item.removeClass("hidden")}}if(typeof(item.opacity)!="undefined"){_item.css("opacity",item.opacity)}_item=null};prx.updateItemPosition=function(item,containerid,pageid){var _item="";if(typeof(containerid)!="undefined"){_item=$("#"+containerid+"-"+item.id)}else{_item=$("#"+item.id)}var _page=prx.pages[prx.getPageIndexFromId(pageid)];var _orientation=prx.getPageOrientation(_page);var _OrientationWidth=0;var _OrientationHeight=0;_OrientationWidth=prx.devices[prx.device][_orientation][0];_OrientationHeight=prx.devices[prx.device][_orientation][1];if(typeof(_page.statusbar)=="undefined"){_page.statusbar=prx.statusbar}if(typeof(_page.navigationbar)=="undefined"){_page.navigationbar=prx.navigationbar}if(_page.statusbar=="1"){_OrientationHeight=_OrientationHeight-prx.devices[prx.device]["statusbarheight"+_orientation]}if(_page.navigationbar=="1"){_OrientationHeight=_OrientationHeight-prx.devices[prx.device]["navigationbarheight"+_orientation]}var _leftPos=item.left;var _topPos=item.top;var _x=item.left;var _y=item.top;var _wi=item.width;var _hi=item.height;var _width=item.width;var _height=item.height;if(item.width!="full"){switch(item.wtype){case"fixed":_width=_wi;break;case"variable":_width=_OrientationWidth-_wi;break}_item.css("width",_width+"px")}if(item.height!="full"){switch(item.htype){case"fixed":_height=_hi;break;case"variable":_height=_OrientationHeight-_hi;break}_item.css("height",_height+"px")}switch(item.hpos){case"left":_leftPos=_x;break;case"right":_leftPos=_OrientationWidth-_x-_width;break;case"center":_leftPos=(_OrientationWidth-_width)/2;break}_item.css("left",_leftPos+"px");switch(item.vpos){case"top":_topPos=_y;break;case"bottom":_topPos=_OrientationHeight-_y-_height;break;case"middle":_topPos=(_OrientationHeight-_height)/2;break}_item.css("top",_topPos+"px");_item=null};prx.updateSymbolItemPosition=function(item,containerid,pageid,symbol){var _item="";if(typeof(containerid)!="undefined"){_item=$("#"+containerid+"-"+item.id)}else{_item=$("#"+item.id)}var _dims=prx.symbols[prx.getSymbolIndexFromId(symbol.symbolid)].states[0].dimensions;var _page=prx.pages[prx.getPageIndexFromId(pageid)];var _orientation="";var _OrientationWidth=_dims[0];var _OrientationHeight=_dims[1];var _leftPos=item.left;var _topPos=item.top;var _x=item.left;var _y=item.top;var _wi=item.width;var _hi=item.height;var _width=item.width;var _height=item.height;if(item.width!="full"){switch(item.wtype){case"fixed":_width=_wi;break;case"variable":_width=_OrientationWidth-_wi;break}_item.css("width",_width+"px")}if(item.height!="full"){switch(item.htype){case"fixed":_height=_hi;break;case"variable":_height=_OrientationHeight-_hi;break}_item.css("height",_height+"px")}switch(item.hpos){case"left":_leftPos=_x;break;case"right":_leftPos=_OrientationWidth-_x-_width;break;case"center":_leftPos=(_OrientationWidth-_width)/2;break}_item.css("left",_leftPos+"px");switch(item.vpos){case"top":_topPos=_y;break;case"bottom":_topPos=_OrientationHeight-_y-_height;break;case"middle":_topPos=(_OrientationHeight-_height)/2;break}_item.css("top",_topPos+"px");_item=null};prx.updateTemplateItemPosition=function(item,pageid){var _id="#"+item.id;var _page=prx.pages[prx.getPageIndexFromId(pageid)];var _orientation=prx.getPageOrientation(_page);var _OrientationWidth=0;var _OrientationHeight=0;_OrientationWidth=prx.devices[prx.device][_orientation][0];_OrientationHeight=prx.devices[prx.device][_orientation][1];if(typeof(_page.statusbar)=="undefined"){_page.statusbar=prx.statusbar}if(typeof(_page.navigationbar)=="undefined"){_page.navigationbar=prx.navigationbar}if(_page.statusbar=="1"){_OrientationHeight=_OrientationHeight-prx.devices[prx.device]["statusbarheight"+_orientation]}if(_page.navigationbar=="1"){_OrientationHeight=_OrientationHeight-prx.devices[prx.device]["navigationbarheight"+_orientation]}var _leftPos=item.left;var _topPos=item.top;var _x=item.left;var _y=item.top;var _wi=item.width;var _hi=item.height;var _width=item.width;var _height=item.height;if(item.width!="full"){switch(item.wtype){case"fixed":_width=_wi;break;case"variable":_width=_OrientationWidth-_wi;break}item.width=_width}if(item.height!="full"){switch(item.htype){case"fixed":_height=_hi;break;case"variable":_height=_OrientationHeight-_hi;break}item.height=_height}switch(item.hpos){case"left":_leftPos=_x;break;case"right":_leftPos=_OrientationWidth-_x-_width;break;case"center":_leftPos=(_OrientationWidth-_width)/2;break}item.left=_leftPos;switch(item.vpos){case"top":_topPos=_y;break;case"bottom":_topPos=_OrientationHeight-_y-_height;break;case"middle":_topPos=(_OrientationHeight-_height)/2;break}item.top=_topPos;return item};prx.setupShowActionsOnShift=function(){if(!prx.embed&&parent!=window){$(document).keydown(function(e){if(e.which==16&&prx.shiftKeyDown==false){prx.shiftKeyDown=true;parent.prx.showActions();$(parent.document).find("#show-actions").addClass("active").find(".tooltip").text("Show actions")}}).keyup(function(e){if(e.which==16&&prx.shiftKeyDown==true){prx.shiftKeyDown=false;parent.prx.hideActions();$(parent.document).find("#show-actions").removeClass("active").find(".tooltip").text("Show actions")}})}};prx.loadProjectFonts=function(){var _str="";for(var i=0;i<prx.fonts.length;i++){_str+=prx.fonts[i].value+":";for(var j=0;j<prx.fonts[i].variants.length;j++){_str+=prx.fonts[i].variants[j]+","}_str=_str.slice(0,-1)+"|"}_str=_str.slice(0,-1);if(_str!=""){$("head").append('<link href="https://fonts.googleapis.com/css?family='+_str+'" type="text/css" rel="stylesheet"/>')}};Math.precision=function(value,precision){if(precision===undefined){precision=0}return Math.round(value*Math.pow(10,precision))/Math.pow(10,precision)};prx.getColor=function(_ahex){var _r={};_r.hex="FFFFFF";_r.alpha=1;if(_ahex.length>5){_r.hex=_ahex.replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6)}if(_ahex.length==8){_r.alpha=Math.precision((parseInt(_ahex.replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(6,8),16)*100)/255,1)/100}return _r};function NoClickDelay(el){this.element=el;if(window.Touch){this.element.addEventListener("touchstart",this,false)}}var getGuid=function(){var guid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:(r&3|8);return v.toString(16)});return guid};prx.buildStatusBarAsset=function(orientation){if(prx.statusbarapplies=="1"){if(prx.devices[prx.device].statusbar_skin=="default"){return"url("+prx.url.account+"/assets/device/default/statusbar_"+orientation+".png)"}else{if(prx.devices[prx.device].statusbar_skin=="shared"){return"url("+prx.url.account+"/assets/device/shared/"+prx.devices[prx.device].device_uuid+"/statusbar_"+orientation+".png)"}else{return"url("+prx.url.account+"/assets/device/"+prx.devices[prx.device].device_uuid+"/statusbar_"+orientation+".png)"}}}else{return"none"}};prx.buildNavigationBarAsset=function(orientation){if(prx.navigationbarapplies=="1"){if(prx.devices[prx.device].navigationbar_skin=="default"){return"url("+prx.url.account+"/assets/device/default/navigationbar_"+orientation+".png)"}else{if(prx.devices[prx.device].navigationbar_skin=="shared"){return"url("+prx.url.account+"/assets/device/shared/"+prx.devices[prx.device].device_uuid+"/navigationbar_"+orientation+".png)"}else{return"url("+prx.url.account+"/assets/device/"+prx.devices[prx.device].device_uuid+"/navigationbar_"+orientation+".png)"}}}else{return"none"}};prx.v5BackwardsCompatibility=function(){prx.backwardsCompatibilityConvertToStatefulTemplates();prx.backwardsCompatibilityConvertToStatefulPages();if(!(prx.symbols.length>0&&typeof(prx.symbols[0].states)!="undefined")){prx.backwardsCompatibilityConvertToStatefulSymbols()}prx.v5=true};prx.backwardsCompatibilityConvertToStatefulPages=function(index){for(var index=0;index<prx.pages.length;index++){prx.pages[index].states=[];var data=$.evalJSON(prx.pages[index].data);if(prx.getTemplateIndexFromId(data.templateid)>-1){var template={id:data.templateid,stateid:prx.templates[prx.getTemplateIndexFromId(data.templateid)].states[0].id}}else{var template={id:""}}var defaultstate={data:$.toJSON(data.items),template:template,title:"Default State",history:prx.pages[index].history,background:prx.pages[index].background,id:getGuid()};defaultstate=$.toJSON(defaultstate);defaultstate=$.evalJSON(defaultstate);delete prx.pages[index].data;delete prx.pages[index].history;delete prx.pages[index].background;prx.pages[index].states.push(defaultstate)}return true};prx.backwardsCompatibilityConvertToStatefulTemplates=function(){for(var index=0;index<prx.templates.length;index++){prx.templates[index].states=[];var data=$.evalJSON(prx.templates[index].data);var defaultstate={data:$.toJSON(data.items),template:{id:data.templateid,stateid:""},title:"Default State",history:prx.templates[index].history,background:prx.templates[index].background,id:getGuid()};defaultstate=$.toJSON(defaultstate);defaultstate=$.evalJSON(defaultstate);delete prx.templates[index].data;delete prx.templates[index].history;delete prx.templates[index].background;prx.templates[index].states.push(defaultstate)}for(var index=0;index<prx.templates.length;index++){if(prx.templates[index].states[0].template.id!=""&&prx.getTemplateIndexFromId(prx.templates[index].states[0].template.id)>-1){prx.templates[index].states[0].template.stateid=prx.templates[prx.getTemplateIndexFromId(prx.templates[index].states[0].template.id)].states[0].id}}return true};prx.backwardsCompatibilityConvertToStatefulSymbols=function(){for(var index=0;index<prx.symbols.length;index++){prx.symbols[index].states=[];var defaultstate={data:prx.symbols[index].data,dimensions:prx.symbols[index].dimensions,title:"Default State",history:prx.symbols[index].history,background:prx.symbols[index].background,id:getGuid()};defaultstate=$.toJSON(defaultstate);defaultstate=$.evalJSON(defaultstate);delete prx.symbols[index].data;delete prx.symbols[index].dimensions;delete prx.symbols[index].history;delete prx.symbols[index].background;prx.symbols[index].states.push(defaultstate)}return true};prx.getStateIndexFromId=function(id,type,index){if(typeof(type)=="undefined"||typeof(index)=="undefined"||index==-1){return -1}if(typeof(prx[type][index])=="undefined"){return -1}for(var i=0;i<prx[type][index].states.length;i++){if(prx[type][index].states[i].id==id){return i}}return -1};prx.getPageStateIndexFromId=function(id,index){return prx.getStateIndexFromId(id,"pages",index)};prx.getTemplateStateIndexFromId=function(id,index){return prx.getStateIndexFromId(id,"templates",index)};prx.getSymbolStateIndexFromId=function(id,index){return prx.getStateIndexFromId(id,"symbols",index)};prx.getChangesBetweenStates=function(fromstateid,tostateid,type,index){if(typeof(type)=="undefined"){type=type=prx.getPageTemplateSymbolType()}if(typeof(index)=="undefined"){index=prx.getPageTemplateSymbolIndex()}var changes=[];var fromstateindex=prx.getStateIndexFromId(fromstateid,type,index);var tostateindex=prx.getStateIndexFromId(tostateid,type,index);if(fromstateindex==-1||tostateindex==-1){return false}switch(type){case"pages":case"templates":if(getColor(prx[type][index].states[fromstateindex].background)!=getColor(prx[type][index].states[tostateindex].background)||prx[type][index].states[fromstateindex].template.stateid!=prx[type][index].states[tostateindex].template.stateid){var containerChanges=(type=="pages")?{type:"page-properties",id:"current-page",changes:{}}:{type:"template-properties",id:"current-page-template",changes:{}};if(getColor(prx[type][index].states[fromstateindex].background)!=getColor(prx[type][index].states[tostateindex].background)){containerChanges.changes.background=[prx[type][index].states[fromstateindex].background,prx[type][index].states[tostateindex].background]}if(prx[type][index].states[fromstateindex].template.stateid!=prx[type][index].states[tostateindex].template.stateid){containerChanges.changes.templatestateid=[prx[type][index].states[fromstateindex].template.stateid,prx[type][index].states[tostateindex].template.stateid]}changes.push(containerChanges)}break;break;case"symbols":if(prx[type][index].states[fromstateindex].dimensions[0]!=prx[type][index].states[tostateindex].dimensions[0]||prx[type][index].states[fromstateindex].dimensions[1]!=prx[type][index].states[tostateindex].dimensions[1]||getColor(prx[type][index].states[fromstateindex].background)!=getColor(prx[type][index].states[tostateindex].background)){var containerChanges={type:"container-properties",id:"current-container",changes:{}};if(prx[type][index].states[fromstateindex].dimensions[0]!=prx[type][index].states[tostateindex].dimensions[0]){containerChanges.changes.width=[prx[type][index].states[fromstateindex].dimensions[0],prx[type][index].states[tostateindex].dimensions[0]]}if(prx[type][index].states[fromstateindex].dimensions[1]!=prx[type][index].states[tostateindex].dimensions[1]){containerChanges.changes.height=[prx[type][index].states[fromstateindex].dimensions[1],prx[type][index].states[tostateindex].dimensions[1]]}if(getColor(prx[type][index].states[fromstateindex].background)!=getColor(prx[type][index].states[tostateindex].background)){containerChanges.changes.background=[prx[type][index].states[fromstateindex].background,prx[type][index].states[tostateindex].background]}changes.push(containerChanges)}break}var fromstate=prx[type][index].states[fromstateindex].data;var tostate=prx[type][index].states[tostateindex].data;if(fromstate==tostate){return changes}fromstate=$.evalJSON(fromstate);tostate=$.evalJSON(tostate);var fromlist=[];var tolist=[];for(var i=0;i<fromstate.length;i++){fromlist.push(fromstate[i].id)}for(i=0;i<tostate.length;i++){tolist.push(tostate[i].id)}if(fromlist.toString()!=tolist.toString()){if(fromlist.slice(0).sort().toString()!=tolist.slice(0).sort().toString()){for(i=0;i<fromlist.length;i++){if(tolist.indexOf(fromlist[i])==-1){var comp_changes={};comp_changes.opacity=[fromlist[i].opacity,0];changes.push({type:"removed-component",id:fromlist[i],item:fromstate[i],componentType:fromstate[i].type,changes:comp_changes});fromlist.splice(i,1);i--}}for(i=0;i<tolist.length;i++){if(fromlist.indexOf(tolist[i])==-1){for(j=0;j<tostate.length;j++){if(tostate[j].id==tolist[i]){var comp_changes={};comp_changes.opacity=[0,tostate[j].opacity];var item=tostate[j];item.opacity=0;changes.push({type:"new-component",id:tolist[i],componentType:tostate[j].type,item:item,changes:comp_changes});tolist.splice(i,1);i--;break}}}}}if(fromlist.toString()!=tolist.toString()){changes.push({type:"reordered-components",new_order:tolist.toString(),old_order:fromlist.toString()})}for(i=0;i<fromstate.length;i++){if(typeof(fromstate[i].zindex)!="undefined"){delete fromstate[i].zindex}}for(i=0;i<tostate.length;i++){if(typeof(tostate[i].zindex)!="undefined"){delete tostate[i].zindex}}}for(i=0;i<fromstate.length;i++){for(var j=0;j<tostate.length;j++){if(tostate[j].id==fromstate[i].id){var diffs=jsondiffpatch.diff(fromstate[i],tostate[j]);if(typeof(diffs)!="undefined"){for(var diff in diffs){if(diffs.hasOwnProperty(diff)){if($.isArray(diffs[diff])){if((typeof(diffs[diff][0])=="string"&&typeof(diffs[diff][1])=="number"&&parseFloat(diffs[diff][0])==diffs[diff][1])||(typeof(diffs[diff][1])=="string"&&typeof(diffs[diff][0])=="number"&&parseFloat(diffs[diff][1])==diffs[diff][0])){delete diffs[diff]}if(diff=="draggable"&&diffs[diff].length==1){if(!diffs[diff][0].isdraggable){delete diffs[diff]}else{if(typeof(tostate[j].draggable)!="undefined"&&tostate[j].draggable.isdraggable){diffs[diff]=[fromstate[i].draggable,tostate[j].draggable]}}}}}}if(typeof(diffs.width)!="undefined"||typeof(diffs.wtype)!="undefined"||typeof(diffs.height)!="undefined"||typeof(diffs.htype)!="undefined"||typeof(diffs.left)!="undefined"||typeof(diffs.hpos)!="undefined"||typeof(diffs.top)!="undefined"||typeof(diffs.vpos)!="undefined"){var realDimsFrom=prx.getRealItemDimsAndPos(fromstate[i],type,index,fromstateindex);var realDimsTo=prx.getRealItemDimsAndPos(tostate[j],type,index,tostateindex);if(typeof(diffs.width)!="undefined"||typeof(diffs.wtype)!="undefined"){if(typeof(diffs.wtype)!="undefined"){delete diffs.wtype}diffs.width=[realDimsFrom[0],realDimsTo[0]];if(realDimsFrom[0]==realDimsTo[0]){delete diffs.width}}if(typeof(diffs.height)!="undefined"||typeof(diffs.htype)!="undefined"){if(typeof(diffs.htype)!="undefined"){delete diffs.htype}diffs.height=[realDimsFrom[1],realDimsTo[1]];if(realDimsFrom[1]==realDimsTo[1]){delete diffs.height}}if(typeof(diffs.left)!="undefined"||typeof(diffs.hpos)!="undefined"){if(typeof(diffs.hpos)!="undefined"){delete diffs.hpos}diffs.left=[realDimsFrom[2],realDimsTo[2]];if(realDimsFrom[2]==realDimsTo[2]){delete diffs.left}}if(typeof(diffs.top)!="undefined"||typeof(diffs.vpos)!="undefined"){if(typeof(diffs.vpos)!="undefined"){delete diffs.vpos}diffs.top=[realDimsFrom[3],realDimsTo[3]];if(realDimsFrom[3]==realDimsTo[3]){delete diffs.top}}}if(typeof(diffs.visible)!="undefined"){if(diffs.visible[1]==false){diffs.visible=[fromstate[i].opacity,0]}else{diffs.visible=[0,tostate[j].opacity]}}$.each(diffs,function(key,value){diffs[key]=[fromstate[i][key],tostate[j][key]]});if(typeof(prx.types[fromstate[i].type])!="undefined"&&typeof(prx.types[fromstate[i].type].dynamicProperties)!="undefined"){var dynprop=prx.types[fromstate[i].type].dynamicProperties.data;if(typeof(diffs[dynprop])!="undefined"){delete diffs[dynprop];if(fromstate[i][dynprop].length!=tostate[j][dynprop].length){diffs.dynamicProperties={type:""}}else{for(var k=0;k<fromstate[i][dynprop].length;k++){var dyndiffs=jsondiffpatch.diff(fromstate[i][dynprop][k],tostate[j][dynprop][k]);if(typeof(dyndiffs)!="undefined"){for(var dyndiff in dyndiffs){if(dyndiffs.hasOwnProperty(dyndiff)){if($.isArray(dyndiffs[dyndiff])){diffs["dynamicProperties-"+k+"-"+dyndiff]=dyndiffs[dyndiff]}else{diffs["dynamicProperties-"+k+"-"+dyndiff]=[fromstate[i][dynprop][k][dyndiff],tostate[j][dynprop][k][dyndiff]]}}}}}}}}if(Object.keys(diffs).length>0){var change={type:"changed-component",id:fromstate[i].id,componentType:fromstate[i].type,changes:diffs};if(typeof(diffs.width)!="undefined"||typeof(diffs.height)!="undefined"){change.item=tostate[j]}changes.push(change)}}}}}return changes};prx.getRealItemDimsAndPos=function(item,parenttype,parentindex,parentstateindex){var _OrientationDims=prx.getObjectDims(parenttype,parentindex,parentstateindex);var _width=item.width;var _height=item.height;var _left=item.left;var _top=item.top;if(item.wtype=="variable"){_width=_OrientationDims[0]-_width}if(item.htype=="variable"){_height=_OrientationDims[1]-_height}if(item.hpos=="right"){_left=_OrientationDims[0]-_left-_width}if(item.hpos=="center"){_left=(_OrientationDims[0]-_width)/2}if(item.vpos=="bottom"){_top=_OrientationDims[1]-_top-_height}if(item.vpos=="middle"){_top=(_OrientationDims[1]-_height)/2}return[parseInt(_width),parseInt(_height),parseInt(_left),parseInt(_top)]};prx.getObjectDims=function(type,index,stateindex){if(stateindex==-1){return false}switch(type){case"symbols":return[prx[type][index].states[stateindex].dimensions[0],prx[type][index].states[stateindex].dimensions[1]];break;default:var _orientation=prx[type][index].orientation;var _OrientationWidth=0;var _statusbarHeight=0;var _statusbar=0;var _navigationbarHeight=0;var _navigationbar=0;if(prx.statusbarapplies&&prx[type][index].statusbar=="1"){_statusbar=1;_statusbarHeight=prx.devices[prx.device]["statusbarheight"+_orientation]}if(prx.navigationbarapplies&&prx[type][index].navigationbar=="1"){_navigationbar=1;_navigationbarHeight=prx.devices[prx.device]["navigationbarheight"+_orientation]}var _deadheight=parseInt(_statusbar)*prx.devices[prx.device]["statusbarheight"+_orientation]+parseInt(_navigationbar)*prx.devices[prx.device]["navigationbarheight"+_orientation];var _OrientationWidth=prx.devices[prx.device]["normal"+_orientation][0];var _OrientationHeight=prx.devices[prx.device]["normal"+_orientation][1]-_deadheight;return[_OrientationWidth,_OrientationHeight];break}};prx.goToPage=function(pageid){try{_currentpage="#"+$.mobile.activePage.get(0).id}catch(err){_currentpage="#"+$(".ui-page-active").first().attr("id")}_gobackstack.push(_currentpage);if(_gobackstack.length>=50){_gobackstack.shift()}$.mobile.changePage($("#p-"+pageid),{transition:"none",allowSamePageTransition:true,changeHash:prx.pagehash});prx.eventTransitionPage="#p-"+pageid};prx.triggerKeydownAction=function(e){$(document).trigger(e)};prx.triggerOrientationChange=function(){prx.changeOrientation()};prx.buildAnimationProperties=function(props,action){var _props=props;var _options={};_options.duration=parseInt(props.duration);_options.easing=props.easing;_options.queue=props.queue;_options.complete=function(){prx.callbackAction(action)};delete _props.duration;delete _props.easing;delete _props.queue;return{properties:_props,options:_options}};prx.getPageOrientation=function(page,stateindex){if(typeof(stateindex)=="undefined"){stateindex=0}var _orientation=prx.devices[prx.device].defaultOrientation;if(typeof(page.orientation)=="undefined"||page.orientation==""){page.orientation=prx.devices[prx.device].defaultOrientation}_orientation=page.orientation;if(!prx.devices[prx.device][_orientation+"_applies"]){_orientation=(_orientation=="portrait")?"landscape":"portrait"}return _orientation};prx.recursivelyFindItemSymbolId=function(itemid,type,index){var singleitemid=itemid.split("-box-")[0];var items=prx.getAllItems(type,index);for(var i=0;i<items.length;i++){if(items[i].id==singleitemid){if(itemid==singleitemid){if(typeof(items[i].symbolid)=="undefined"){return false}return items[i].symbolid}else{itemid=itemid.substr((singleitemid+"-").length);return prx.recursivelyFindItemSymbolId(itemid,"symbols",prx.getSymbolIndexFromId(items[i].symbolid))}}}};function getColor(color){if(typeof(color)=="undefined"){return""}if(color=="none"){return"rgba(0,0,0,0)"}if(color==color.replace(/[^A-F0-9]/ig,"")){return"#"+color}return color};